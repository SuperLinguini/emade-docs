
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>GPFramework.spatial_methods &#8212; EMADE 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for GPFramework.spatial_methods</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Programmed by Jason Zutty</span>
<span class="sd">Modified by VIP Team</span>
<span class="sd">Implements a number of spatial methods for use with deap</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">GPFramework.data</span> <span class="k">import</span> <span class="n">GTMOEPData</span><span class="p">,</span> <span class="n">GTMOEPDataPair</span>
<span class="kn">import</span> <span class="nn">copy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">signal</span>
<span class="kn">import</span> <span class="nn">heapq</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">wraps</span>

<span class="c1"># GP Framework data types</span>
<span class="n">FEATURES_TO_FEATURES</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">STREAM_TO_STREAM</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">STREAM_TO_FEATURES</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># profiler data</span>
<span class="n">PROF_DATA</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="profile"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.profile">[docs]</a><span class="k">def</span> <span class="nf">profile</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;function profiling</span>

<span class="sd">    Args:</span>
<span class="sd">        fn: function</span>

<span class="sd">    Returns:</span>
<span class="sd">        a function</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    wrapper for function profiling</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">with_profiling</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

        <span class="k">if</span> <span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">PROF_DATA</span><span class="p">:</span>
            <span class="n">PROF_DATA</span><span class="p">[</span><span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[]]</span>
        <span class="n">PROF_DATA</span><span class="p">[</span><span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">PROF_DATA</span><span class="p">[</span><span class="n">fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elapsed_time</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">return</span> <span class="n">with_profiling</span></div>


<div class="viewcode-block" id="print_prof_data"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.print_prof_data">[docs]</a><span class="k">def</span> <span class="nf">print_prof_data</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Prints profile data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">fname</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">PROF_DATA</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">max_time</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">avg_time</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Function </span><span class="si">%s</span><span class="s2"> called </span><span class="si">%d</span><span class="s2"> times. &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Execution time max: </span><span class="si">%.3f</span><span class="s1">, average: </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">max_time</span><span class="p">,</span> <span class="n">avg_time</span><span class="p">))</span></div>


<div class="viewcode-block" id="clear_prof_data"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.clear_prof_data">[docs]</a><span class="k">def</span> <span class="nf">clear_prof_data</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Clears all profile data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">PROF_DATA</span>
    <span class="n">PROF_DATA</span> <span class="o">=</span> <span class="p">{}</span></div>


<div class="viewcode-block" id="check_kernel_size"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.check_kernel_size">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">check_kernel_size</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checks kernel size</span>

<span class="sd">    Args:</span>
<span class="sd">        k: size</span>

<span class="sd">    Returns:</span>
<span class="sd">        positive odd integer suitable for use as an image kernel size</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">k</span></div>


<div class="viewcode-block" id="imshow"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.imshow">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">imshow</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Shows an image</span>

<span class="sd">    the following code must appear when you want to display the images</span>
<span class="sd">    cv2.waitKey(0)</span>
<span class="sd">    cv2.destroyAllWindows()</span>

<span class="sd">    Args:</span>
<span class="sd">        title: title of the window</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dataset_number</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">dataset_number</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">instance_number</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">instance_number</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">title</span> <span class="o">+=</span> <span class="s1">&#39; d=</span><span class="si">{0:d}</span><span class="s1"> i=</span><span class="si">{1:d}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dataset_number</span><span class="p">,</span> <span class="n">instance_number</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></div>


<div class="viewcode-block" id="imshow1"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.imshow1">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">imshow1</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Shows an image</span>

<span class="sd">    the following code must appear when you want to display the images</span>
<span class="sd">    cv2.waitKey(0)</span>
<span class="sd">    cv2.destroyAllWindows()</span>

<span class="sd">    Args:</span>
<span class="sd">        title: title of the window</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dataset_number</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()]:</span>
        <span class="n">dataset_number</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">instance_number</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">instance_number</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">cv2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></div>


<div class="viewcode-block" id="imsave"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.imsave">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">imsave</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Saves an image</span>

<span class="sd">    Args:</span>
<span class="sd">        filename: name of the file</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dataset_number</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()]:</span>
        <span class="n">dataset_number</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">instance_number</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">instance_number</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">cv2</span><span class="o">.</span><span class="n">imwrite</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">data</span><span class="p">)</span></div>


<div class="viewcode-block" id="print_info"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.print_info">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">print_info</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Prints information about an image</span>

<span class="sd">    Args:</span>
<span class="sd">        title: title of the image</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dataset_number</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()]:</span>
        <span class="n">dataset_number</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">instance_number</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">instance_number</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">title</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dtype: </span><span class="si">{0:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;max: </span><span class="si">{0:f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;min: </span><span class="si">{0:f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;shape: </span><span class="si">{0:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)))</span></div>


<div class="viewcode-block" id="minimum_to_zero"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.minimum_to_zero">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">minimum_to_zero</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Shift the entire image such that the minimum value is zero</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">m</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="to_uint8"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.to_uint8">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">to_uint8</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert to uint8</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="to_uint8_scale"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.to_uint8_scale">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">to_uint8_scale</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Scale the image values from 0 to 256, image returned as a uint8</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">max_value</span> <span class="o">=</span> <span class="mi">256</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
            <span class="n">minval</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="n">maxval</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">convertScaleAbs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">255.0</span><span class="o">/</span><span class="p">(</span><span class="n">maxval</span><span class="o">-</span><span class="n">minval</span><span class="p">),</span> <span class="n">beta</span><span class="o">=-</span><span class="mi">1</span><span class="o">*</span><span class="n">minval</span><span class="o">*</span><span class="mi">255</span><span class="o">/</span><span class="p">(</span><span class="n">maxval</span><span class="o">-</span><span class="n">minval</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="to_float"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.to_float">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">to_float</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert to float</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="to_float_normalize"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.to_float_normalize">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">to_float_normalize</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert to float and normalize</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">/</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<span class="c1"># edge detection</span>


<div class="viewcode-block" id="edge_detection_canny"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.edge_detection_canny">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">edge_detection_canny</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">t1</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">t2</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">apertureSize</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform the Canny edge detection algorithm on the image using the default sobel window size of three and the</span>
<span class="sd">    higher accuracy gradient estimation technique</span>

<span class="sd">    http://docs.opencv.org/trunk/da/d22/tutorial_py_canny.html#gsc.tab=0</span>

<span class="sd">    Edges &gt; t2 are in the output image</span>
<span class="sd">    Edges &gt; t1 that touch something &gt; t2 are in the image</span>
<span class="sd">    Edges &lt; t1 are not in the image</span>

<span class="sd">    Ratio of t2:t1 should be between 2:1 and 3:1</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        t1: Lower edge threshold</span>
<span class="sd">        t2: Upper edge threshold</span>
<span class="sd">        aperatureSize: Aperature size of the Sobel gradient function</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">t1</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">t1</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">t2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">t2</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">]</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="c1"># apply the Canny algorithm http://docs.opencv.org/trunk/da/d22/tutorial_py_canny.html#gsc.tab=0</span>
            <span class="c1"># Use the higher precision gradient estimation function</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">Canny</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">apertureSize</span><span class="o">=</span><span class="n">apertureSize</span><span class="p">,</span> <span class="n">L2gradient</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="corner_detection_harris"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.corner_detection_harris">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">corner_detection_harris</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">blocksize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.04</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform Harris corner detection</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair, uint8</span>
<span class="sd">        blocksize: Area on which to construct local gradient</span>
<span class="sd">        kernel_size: kernel size for Sobel</span>
<span class="sd">        k: Harris detector free parameter</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair, non-normalized float, some values may be negative</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">blocksize</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">blocksize</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">kernel_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="c1"># returns a floating point image with values &gt; 1</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cornerHarris</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">blockSize</span><span class="o">=</span><span class="n">blocksize</span><span class="p">,</span> <span class="n">ksize</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="corner_detection_min_eigen_val"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.corner_detection_min_eigen_val">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">corner_detection_min_eigen_val</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">blocksize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform Harris corner detection</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair, uint8</span>
<span class="sd">        blocksize: Area on which to construct local gradient</span>
<span class="sd">        kernel_size: kernel size for Sobel</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair, non-normalized float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">blocksize</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">blocksize</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">kernel_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="c1"># returns a floating point image with values &gt; 1</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cornerMinEigenVal</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">blocksize</span><span class="p">,</span> <span class="n">ksize</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<span class="c1"># high pass filters</span>


<div class="viewcode-block" id="highpass_fourier_ellipsoid"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.highpass_fourier_ellipsoid">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">highpass_fourier_ellipsoid</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform an ellipsoid low pass filter in the frequency domain and subtract that from the original image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair, uint8 or float</span>
<span class="sd">        size: size of the box used for filtering</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair, non-normalized float, some values may be negative</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">size</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">org</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">fourier_ellipsoid</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">org</span> <span class="o">-</span> <span class="n">data</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="highpass_irst"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.highpass_irst">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">highpass_irst</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implements the HPF used in the IRST algorithm</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair, uint8 or float</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair, non-normalized float, some values may be negative</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
            <span class="n">kernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">kernel</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">kernel</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="n">kernel</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">kernel</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">filter2D</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="median_filter"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.median_filter">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">median_filter</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Median filter</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_size: size of kernel for std deviation</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kernel_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">medfilt2d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="lowpass_fourier_shift"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.lowpass_fourier_shift">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">lowpass_fourier_shift</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform a shift low pass filter in the frequency domain</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        shift: the size of the box used for filtering</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">shift</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">shift</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">fourier_shift</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="highpass_fourier_shift"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.highpass_fourier_shift">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">highpass_fourier_shift</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform a shift low pass filter in the frequency domain subtracted</span>
<span class="sd">    from the original image to produce a high pass filtered image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        shift: the size of the box used for filtering</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">shift</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">shift</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">fourier_shift</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">shift</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="highpass_fourier_gaussian"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.highpass_fourier_gaussian">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">highpass_fourier_gaussian</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform a gaussian low pass filter in the frequency domain and subtract</span>
<span class="sd">    from the original image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        sigma: the sigma of the Gaussian kernel</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">sigma</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sigma</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">org</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">fourier_gaussian</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">org</span> <span class="o">-</span> <span class="n">data</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="highpass_fourier_uniform"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.highpass_fourier_uniform">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">highpass_fourier_uniform</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform an uniform low pass filter in the frequency domain and</span>
<span class="sd">    subtract this from the original image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        size: the size of the box used for filtering</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">size</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">org</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">fourier_uniform</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">org</span> <span class="o">-</span> <span class="n">data</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="highpass_unsharp_mask"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.highpass_unsharp_mask">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">highpass_unsharp_mask</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Unsharp mask, high pass filter</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_size: Positive odd integer &gt; 1.  Size of the kernel used in the</span>
<span class="sd">        gaussian filtering step</span>
<span class="sd">        sigma: the standard deviation to use in the gaussian filtering step</span>
<span class="sd">        weight: weight used to emphasize changes in image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kernel_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sigma</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">sigma</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sigma</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">if</span> <span class="n">weight</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">weight</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">weight</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">alpha</span> <span class="o">=</span> <span class="n">weight</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">gaussian</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">),</span> <span class="n">sigma</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">addWeighted</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">gaussian</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="highpass_laplacian"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.highpass_laplacian">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">highpass_laplacian</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Laplacian of an image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_size: Aperture size used to compute the second-derivative filters</span>
<span class="sd">        scale: Optional scale factor for the computed Laplacian values.</span>
<span class="sd">        By default, no scaling is applied</span>
<span class="sd">        delta: Optional delta value that is added to the results</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kernel_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">scale</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">scale</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">scale</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">Laplacian</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ddepth</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">ksize</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="n">delta</span><span class="p">)</span>
            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="highpass_sobel_derivative"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.highpass_sobel_derivative">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">highpass_sobel_derivative</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ksize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sobel Derivative</span>

<span class="sd">    kernel size has to be greater than the derivative order</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        dx: first, second, or third derivative [1,2,3]</span>
<span class="sd">        dy: first, second, or third derivative [1,2,3]</span>
<span class="sd">        ksize: kernel size</span>
<span class="sd">        scale: scale factor to be applied to final image</span>
<span class="sd">        delta: additive factor to final image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">derivative_order</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">derivative_order</span><span class="p">[</span><span class="n">dx</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">derivative_order</span><span class="p">)]</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">derivative_order</span><span class="p">[</span><span class="n">dy</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">derivative_order</span><span class="p">)]</span>

    <span class="n">ksize</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">ksize</span><span class="p">)</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">]</span>
    <span class="n">ksize</span> <span class="o">=</span> <span class="n">sizes</span><span class="p">[</span><span class="n">ksize</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">sizes</span><span class="p">)]</span>

    <span class="nb">max</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dx</span> <span class="o">&gt;</span> <span class="n">dy</span><span class="p">:</span>
        <span class="n">order</span> <span class="o">=</span> <span class="n">dx</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">order</span> <span class="o">=</span> <span class="n">dy</span>

    <span class="k">if</span> <span class="n">order</span> <span class="o">&gt;</span> <span class="n">ksize</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ksize</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">order</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">ksize</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ksize</span> <span class="o">+=</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="n">scale</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">scale</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">scale</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">cv2</span><span class="o">.</span><span class="n">Sobel</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ddepth</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">ksize</span><span class="o">=</span><span class="n">ksize</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="n">delta</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<span class="c1"># low pass filters</span>

<div class="viewcode-block" id="lowpass_filter_median"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.lowpass_filter_median">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">lowpass_filter_median</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">filter_size</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs a spatial median lowpass filter on Stream Data</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        filter_size: must be a positive odd integer &gt; 1</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># ensure filter_size is valid</span>
    <span class="n">filter_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">filter_size</span><span class="p">)</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">medianBlur</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">filter_size</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="median_blur"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.median_blur">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">median_blur</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">filter_size</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the median of an image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        filter_size: must be a positive odd integer &gt; 1</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">lowpass_filter_median</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">filter_size</span><span class="p">)</span></div>


<div class="viewcode-block" id="lowpass_filter_average"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.lowpass_filter_average">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">lowpass_filter_average</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Normalized average low pass filter</span>

<span class="sd">    :param data_pair:</span>
<span class="sd">    :param kernel_size: must be a positive odd integer &gt; 1</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kernel_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">),</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="blur"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.blur">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">blur</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">filter_size</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">lowpass_filter_average</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">filter_size</span><span class="p">)</span></div>


<div class="viewcode-block" id="lowpass_filter_gaussian"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.lowpass_filter_gaussian">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">lowpass_filter_gaussian</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_size_x</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">kernel_size_y</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">sigma_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">sigma_y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs a Gaussian low pass filter</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_size_x: odd integer &gt; 1</span>
<span class="sd">        kernel_size_y: odd integer &gt; 1</span>
<span class="sd">        sigma_x: positive integer</span>
<span class="sd">        sigma_y: positive integer</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kernel_size_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size_x</span><span class="p">)</span>
    <span class="n">kernel_size_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size_y</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sigma_x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sigma_x</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">if</span> <span class="n">sigma_y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sigma_y</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_size_x</span><span class="p">,</span> <span class="n">kernel_size_y</span><span class="p">),</span> <span class="n">sigma_x</span><span class="p">,</span> <span class="n">sigma_y</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="lowpass_filter_bilateral"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.lowpass_filter_bilateral">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">lowpass_filter_bilateral</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">filter_diameter</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">sigma_color</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">sigma_space</span><span class="o">=</span><span class="mi">75</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs a normalized average low pass filter</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        filter_diameter: Diameter of each pixel neighborhood that is used</span>
<span class="sd">        during filtering. If it is non-positive, it is computed from sigma_space</span>
<span class="sd">        sigma_color: Filter sigma in the color space. A larger value of the</span>
<span class="sd">        parameter means that farther colors within the pixel</span>
<span class="sd">        neighborhood (see sigmaSpace ) will be mixed together, resulting in</span>
<span class="sd">        larger areas of semi-equal color.</span>
<span class="sd">        sigma_space: Filter sigma in the coordinate space. A larger value of</span>
<span class="sd">        the parameter means that farther pixels will influence each other as</span>
<span class="sd">        long as their colors are close enough (see sigmaColor ). When d&gt;0, it</span>
<span class="sd">        specifies the neighborhood size regardless of sigmaSpace . Otherwise,</span>
<span class="sd">        d is proportional to sigmaSpace</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># ensure filter_size is valid</span>
    <span class="n">filter_diameter</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">filter_diameter</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sigma_color</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sigma_color</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">sigma_color</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sigma_color</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">sigma_space</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sigma_space</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">sigma_space</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sigma_space</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bilateralFilter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">filter_diameter</span><span class="p">,</span> <span class="n">sigma_color</span><span class="p">,</span> <span class="n">sigma_space</span><span class="p">)</span>
            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="lowpass_fourier_ellipsoid"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.lowpass_fourier_ellipsoid">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">lowpass_fourier_ellipsoid</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs an ellipsoid low pass filter in the frequency domain</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        size: the size of the box used for filtering</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">size</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">fourier_ellipsoid</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="lowpass_fourier_gaussian"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.lowpass_fourier_gaussian">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">lowpass_fourier_gaussian</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform a Gaussian low pass filter in the frequency domain</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        sigma: the sigma of the Gaussian kernel</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">sigma</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">sigma</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">fourier_gaussian</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="lowpass_fourier_uniform"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.lowpass_fourier_uniform">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">lowpass_fourier_uniform</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs an uniform low pass filter in the frequency domain</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        size: the size of the box used for filtering</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">size</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">fourier_uniform</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<span class="c1"># Threshold functions</span>


<div class="viewcode-block" id="threshold_binary"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.threshold_binary">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">threshold_binary</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Thresholds an image</span>

<span class="sd">    Sets values &gt; threshold to maxvalue</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        threshold: threshold value</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">threshold</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">threshold</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">:</span>
        <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">maxvalue</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="threshold_binary_float"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.threshold_binary_float">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">threshold_binary_float</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Thresholds an image</span>

<span class="sd">    Sets values &gt; threshold to maxvalue</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        threshold: threshold value</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="p">(</span><span class="n">data_max_x</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">data_max_x</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">maxvalue</span>


            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="threshold_to_zero"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.threshold_to_zero">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">threshold_to_zero</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Thresholds an image</span>

<span class="sd">    Sets values &gt; threshold = value, value &lt; threshold = 0</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        threshold: threshold value</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">threshold</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">threshold</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">:</span>
        <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">maxvalue</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">retval</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_TOZERO</span><span class="p">)</span>
            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span>


    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>


            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="threshold_to_zero_by_pixel_float"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.threshold_to_zero_by_pixel_float">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">threshold_to_zero_by_pixel_float</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Thresholds an image pixel by pixel</span>

<span class="sd">    If data[x][y] &gt; threshold[x][y] then data[x][y] else 0</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: two dimensional image</span>
<span class="sd">        second_pair: two dimensional image the same size as data_pair to act as</span>
<span class="sd">        the threshold value</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="p">(</span><span class="n">data_max_x</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">data_max_x</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">second_data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>


            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="threshold_to_zero_float"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.threshold_to_zero_float">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">threshold_to_zero_float</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Thresholds an image</span>

<span class="sd">    Sets values &gt; threshold = value, value &lt; threshold = 0</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        threshold: threshold value</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="p">(</span><span class="n">data_max_x</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">data_max_x</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="threshold_binary_inverse"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.threshold_binary_inverse">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">threshold_binary_inverse</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Thresholds an image</span>

<span class="sd">    Sets values &gt; threshold to 0</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        threshold: threshold value</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">threshold</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">threshold</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">retval</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxval</span> <span class="o">=</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY_INV</span><span class="p">)</span>
            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="set_to_zero_if_greater_than_data_and_factor"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.set_to_zero_if_greater_than_data_and_factor">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">set_to_zero_if_greater_than_data_and_factor</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Transforms an image</span>

<span class="sd">    Returns data where data_out[x][y] = 0</span>
<span class="sd">    if data[x][y] &gt; alpha * second_data[x][y] else data_out[x][y] = data[x][y]</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair</span>
<span class="sd">        alpha: scaling factor</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="p">(</span><span class="n">data_max_x</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>

            <span class="c1"># if data</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_x</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">second_data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="set_to_zero_if_less_than_data_and_factor"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.set_to_zero_if_less_than_data_and_factor">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">set_to_zero_if_less_than_data_and_factor</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Transforms an image</span>

<span class="sd">    Returns data where data_out[x][y] = 0</span>
<span class="sd">    if data[x][y] &lt; alpha * second_data[x][y] else data_out[x][y] = data[x][y]</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair</span>
<span class="sd">        alpha: scaling factor</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="p">(</span><span class="n">data_max_x</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>

            <span class="c1"># if data</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_x</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">second_data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>

<span class="c1"># Morphological operators</span>


<div class="viewcode-block" id="morph_erosion_rect"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_erosion_rect">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_erosion_rect</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological erosion on image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        iterations: positive integer the number of times to apply the</span>
<span class="sd">        morphological operation</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_RECT</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">erode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_erosion_ellipse"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_erosion_ellipse">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_erosion_ellipse</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological erosion on image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        iterations: positive integer the number of times to apply the</span>
<span class="sd">        morphological operation</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_ELLIPSE</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">erode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_erosion_cross"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_erosion_cross">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_erosion_cross</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological erosion on image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        iterations: positive integer the number of times to apply the</span>
<span class="sd">        morphological operation</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_CROSS</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">erode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_dilate_rect"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_dilate_rect">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_dilate_rect</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological erosion on image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        iterations: positive integer the number of times to apply the</span>
<span class="sd">        morphological operation</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_RECT</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_dilate_ellipse"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_dilate_ellipse">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_dilate_ellipse</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological dilation on image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        iterations: positive integer the number of times to apply the</span>
<span class="sd">        morphological operation</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_ELLIPSE</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_dilate_cross"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_dilate_cross">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_dilate_cross</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological dilation on image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        iterations: positive integer the number of times to apply the</span>
<span class="sd">        morphological operation</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_CROSS</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dilate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">kernel</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="n">iterations</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_open_rect"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_open_rect">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_open_rect</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological opening on image. opening is erosion</span>
<span class="sd">    followed by dilation</span>
<span class="sd">    Useful for removing noise</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_RECT</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_OPEN</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_open_ellipse"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_open_ellipse">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_open_ellipse</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological opening on image. opening is erosion</span>
<span class="sd">    followed by dilation</span>
<span class="sd">    Useful for removing noise</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_ELLIPSE</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_OPEN</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_open_cross"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_open_cross">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_open_cross</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological opening on image. opening is erosion</span>
<span class="sd">    followed by dilation</span>
<span class="sd">    Useful for removing noise</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_CROSS</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_OPEN</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_close_rect"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_close_rect">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_close_rect</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological close on image. closing is dilation</span>
<span class="sd">    followed by erosion</span>
<span class="sd">    Useful for filling in holes in the foreground image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_RECT</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_CLOSE</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_close_ellipse"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_close_ellipse">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_close_ellipse</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological close on image. closing is dilation</span>
<span class="sd">    followed by erosion</span>
<span class="sd">    Useful for filling in holes in the foreground image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_ELLIPSE</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_CLOSE</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_close_cross"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_close_cross">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_close_cross</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological close on image. closing is dilation</span>
<span class="sd">    followed by erosion</span>
<span class="sd">    Useful for filling in holes in the foreground image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_CROSS</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_CLOSE</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_gradient_rect"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_gradient_rect">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_gradient_rect</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological gradient on image. Difference between</span>
<span class="sd">    dilation and erosion.</span>
<span class="sd">    Results look like the outline of an object</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_RECT</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_GRADIENT</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_gradient_ellipse"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_gradient_ellipse">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_gradient_ellipse</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological gradient on image. Difference between</span>
<span class="sd">    dilation and erosion.</span>
<span class="sd">    Results look like the outline of an object</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_ELLIPSE</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_GRADIENT</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_gradient_cross"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_gradient_cross">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_gradient_cross</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological gradient on image. Difference between</span>
<span class="sd">    dilation and erosion.</span>
<span class="sd">    Results look like the outline of an object</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_CROSS</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_GRADIENT</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_tophat_rect"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_tophat_rect">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_tophat_rect</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological top hat on image. Difference between</span>
<span class="sd">    close(image) and image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_RECT</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_TOPHAT</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_tophat_ellipse"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_tophat_ellipse">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_tophat_ellipse</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological top hat on image. Difference between</span>
<span class="sd">    close(image) and image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_ELLIPSE</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_TOPHAT</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_tophat_cross"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_tophat_cross">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_tophat_cross</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological top hat on image. Difference between</span>
<span class="sd">    close(image) and image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_CROSS</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_TOPHAT</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_blackhat_rect"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_blackhat_rect">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_blackhat_rect</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological blackhat on image using rectangular kernel.</span>
<span class="sd">    Difference between close(image) and image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_RECT</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_BLACKHAT</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_blackhat_ellipse"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_blackhat_ellipse">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_blackhat_ellipse</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological blackhat on image.</span>
<span class="sd">    Difference between close(image) and image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_ELLIPSE</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_BLACKHAT</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="morph_blackhat_cross"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.morph_blackhat_cross">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">morph_blackhat_cross</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">kernel_y</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform morphological blackhat on image.</span>
<span class="sd">    Difference between close(image) and image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_x: positive odd integer length of the kernel&#39;s x axis</span>
<span class="sd">        kernel_y: positive odd integer length of the kernel&#39;s y axis</span>
<span class="sd">        binary: perform a binary threshold of the image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_x</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_x</span><span class="p">)</span>
            <span class="n">kernel_y</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_y</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">binary</span><span class="p">:</span>
                <span class="n">threshold</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
                <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">kernel_type</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_CROSS</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getStructuringElement</span><span class="p">(</span><span class="n">kernel_type</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_x</span><span class="p">,</span> <span class="n">kernel_y</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">morphologyEx</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">MORPH_BLACKHAT</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<span class="c1"># scalar mathematical operations</span>


<div class="viewcode-block" id="scalar_add"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.scalar_add">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">scalar_add</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a scalar value to each element of data_pair</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        scalar: value to add</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">scalar</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="scalar_add_float"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.scalar_add_float">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">scalar_add_float</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add a scalar value to each element of data_pair</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        scalar: value to add (float)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">scalar_add</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">scalar</span><span class="p">)</span></div>


<div class="viewcode-block" id="scalar_subtract"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.scalar_subtract">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">scalar_subtract</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Subtract a scalar value to each element of data_pair</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        scalar: value to subtract</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">scalar</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="scalar_subtract_float"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.scalar_subtract_float">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">scalar_subtract_float</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">scalar_subtract</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">scalar</span><span class="p">)</span></div>


<div class="viewcode-block" id="scalar_multiply"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.scalar_multiply">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">scalar_multiply</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Multiply a scalar value to each element of data_pair</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        scalar: value to multiply</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">scalar</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="scalar_multiply_float"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.scalar_multiply_float">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">scalar_multiply_float</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">scalar_multiply</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">scalar</span><span class="p">)</span></div>


<div class="viewcode-block" id="scalar_divide"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.scalar_divide">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">scalar_divide</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Divide a scalar value to each element of data_pair</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        scalar: value to divide</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">cv2</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">scalar</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="scalar_divide_float"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.scalar_divide_float">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">scalar_divide_float</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Divide a scalar value to each element of data_pair</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        scalar: value to divide (float)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">scalar_divide</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">scalar</span><span class="p">)</span></div>


<span class="c1"># logic operators</span>


<div class="viewcode-block" id="bitwise_and"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.bitwise_and">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">bitwise_and</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the per-element bit-wise conjunction of two arrays</span>
<span class="sd">    or an array and a scalar</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair or scalar</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">cv2</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="bitwise_not"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.bitwise_not">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">bitwise_not</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Inverts every bit of an array</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bitwise_not</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="bitwise_or"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.bitwise_or">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">bitwise_or</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the per-element bit-wise disjunction of two arrays</span>
<span class="sd">    or an array and a scalar</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair or scalar</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bitwise_or</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="bitwise_xor"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.bitwise_xor">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">bitwise_xor</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the bitwize exclusive or</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair or scalar</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bitwise_xor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<span class="c1"># image mathematical operations</span>


<div class="viewcode-block" id="absdiff"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.absdiff">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">absdiff</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the per-element absolute difference between two arrays or</span>
<span class="sd">    between an array and a scalar</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair or scalar</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">cv2</span><span class="o">.</span><span class="n">absdiff</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="add"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.add">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add second_pair to data_pair. Data_pair contains the sum</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="add_weighted"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.add_weighted">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">add_weighted</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the weighted sum of two arrays</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair</span>
<span class="sd">        alpha: weight assigned to data_pair</span>
<span class="sd">        beta: weight assigned to second_pair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">addWeighted</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">second_data</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="add_weighted_float"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.add_weighted_float">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">add_weighted_float</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the weighted sum of two (float) arrays</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair</span>
<span class="sd">        alpha: weight assigned to data_pair</span>
<span class="sd">        beta: weight assigned to second_pair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">add_weighted</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span></div>


<div class="viewcode-block" id="add_weighted_scale"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.add_weighted_scale">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">add_weighted_scale</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the weighted sum of two arrays and scales the result</span>
<span class="sd">    from 0 to 256</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair</span>
<span class="sd">        alpha: weight assigned to data_pair</span>
<span class="sd">        beta: weight assigned to second_pair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">addWeighted</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">second_data</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="subtract"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.subtract">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">subtract</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Subtract second_pair to data_pair. Data_pair contains the result</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="subtract_saturate"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.subtract_saturate">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">subtract_saturate</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Subtract second_pair to data_pair. Data_pair contains the result</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">xmax</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">):</span>
                    <span class="n">diff</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">-</span> <span class="n">second_data</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">diff</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="multiply"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.multiply">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Multiply second_pair to data_pair. Data_pair contains the result</span>
<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="multiply_transposed"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.multiply_transposed">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">multiply_transposed</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the product of a matrix and its transposition</span>

<span class="sd">    (data_pair)transpose(data_pair)</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">cv2</span><span class="o">.</span><span class="n">mulTransposed</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">aTa</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="random_uniform"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.random_uniform">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">random_uniform</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">255</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a single uniformly-distributed random number or an array of</span>
<span class="sd">    random numbers</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        low: Inclusive lower boundary of the generated random numbers</span>
<span class="sd">        high: Exclusive upper boundary of the generated random numbers</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">cv2</span><span class="o">.</span><span class="n">randu</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="random_normal"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.random_normal">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">random_normal</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">normal_mean</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a single normally distributed random number or an array of</span>
<span class="sd">    random numbers</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        normal_mean: the average</span>
<span class="sd">        std_dev: the standard deviation</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">cv2</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">normal_mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="random_shuffle"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.random_shuffle">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">random_shuffle</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Shuffles the array elements randomly</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">cv2</span><span class="o">.</span><span class="n">randShuffle</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="sqrt"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.sqrt">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the square root</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="divide"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.divide">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">divide</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Divide second_pair to data_pair.  Data_pair contains the result</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given data_pair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="np_divide"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.np_divide">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">np_divide</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Divide second_pair to data_pair.  Data_pair contains the result</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given data_pair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="p">(</span><span class="n">xmax</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">xmax</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">second_data</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">/</span> <span class="n">second_data</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span>


            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="my_pow"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.my_pow">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">my_pow</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">power</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Raises every array element to a power</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        power: power to raise elements to</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">power</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="rms"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.rms">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">rms</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculate the RMS value for the image in data_pair</span>

<span class="sd">    x = width of image</span>
<span class="sd">    y = height of image</span>
<span class="sd">    I = image</span>

<span class="sd">    rms = sqrt(blur(I*I) - blur(I)*blur(I))</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_size: size of kernel</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="c1"># avg(Img^2)</span>
            <span class="n">img_sq</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="n">avg_img_sq</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">img_sq</span><span class="p">,</span> <span class="n">ksize</span><span class="o">=</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">))</span>

            <span class="c1"># avg(I)avg(I)</span>
            <span class="n">avg</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ksize</span><span class="o">=</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">))</span>
            <span class="n">avg_sq</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">avg</span><span class="p">,</span> <span class="n">avg</span><span class="p">)</span>

            <span class="c1"># sqrt( avg(I^2) - avg(I)avg(I))</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">avg_img_sq</span><span class="p">,</span><span class="n">avg_sq</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="dct"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.dct">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">dct</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Discrete Cosine Transform</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dct</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="idct"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.idct">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">idct</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Inverse Discrete Cosine Transform</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">idct</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="dft_real"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.dft_real">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">dft_real</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Discrete Fourier transform of a 1D or 2D floating-point array.</span>
<span class="sd">    Returns the real component only.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dft</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">DFT_REAL_OUTPUT</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="idft"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.idft">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">idft</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Inverse Discrete Fourier transform of a 1D or 2D floating-point array.</span>
<span class="sd">    Returns complex</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">idft</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="transpose"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.transpose">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">transpose</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Transposes a matrix</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="log"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.log">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">log</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the natural logarithm of every array element</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="my_max"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.my_max">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">my_max</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the per-element maximum of two arrays</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="my_min"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.my_min">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">my_min</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the per-element minimum of two arrays</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="scalar_max"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.scalar_max">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">scalar_max</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the per-element maximum of an array and a scalar</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        scalar: given scalar</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">scalar</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="scalar_min"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.scalar_min">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">scalar_min</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">scalar</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the per-element minimum of an array and a scalar</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        scalar: given scalar</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">scalar</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="multiply_spectrum"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.multiply_spectrum">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">multiply_spectrum</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the per-element multiplication of two Fourier spectrums.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">mulSpectrums</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<span class="c1"># comparison operators</span>


<div class="viewcode-block" id="equal"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.equal">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">equal</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs the per-element comparison of two arrays or an array and</span>
<span class="sd">    scalar value</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair or scalar</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CMP_EQ</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="greater_than"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.greater_than">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">greater_than</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs the per-element comparison of two arrays or an array and</span>
<span class="sd">    scalar value</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair or scalar</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CMP_GT</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="greater_than_or_equal"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.greater_than_or_equal">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">greater_than_or_equal</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs the per-element comparison of two arrays or an array and</span>
<span class="sd">    scalar value</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair or scalar</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CMP_GE</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="less_than"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.less_than">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">less_than</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs the per-element comparison of two arrays or an array and</span>
<span class="sd">    scalar value</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair or scalar</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CMP_LT</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="less_than_or_equal"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.less_than_or_equal">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">less_than_or_equal</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs the per-element comparison of two arrays or an array and</span>
<span class="sd">    scalar value</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair or scalar</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CMP_LE</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="image_not_equal"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.image_not_equal">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">image_not_equal</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs the per-element comparison of two arrays or an array and</span>
<span class="sd">    scalar value</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair or scalar</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CMP_NE</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="in_range"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.in_range">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">in_range</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checks if array elements lie between the lower bound and the upper bound</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        lower_bound: lower bound</span>
<span class="sd">        upper_bound: upper bound</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO does this even make sense? Check the inRange method</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<span class="c1"># other operators</span>


<div class="viewcode-block" id="std_deviation"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.std_deviation">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">std_deviation</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Standard deviation of an image</span>

<span class="sd">    implements sqrt(blur(img^2) - blur(img)^2)</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_size: size of kernel</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># std_dev = sqrt(1/N*M(I - avg(i))^2)</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="c1"># average is the blur function</span>
            <span class="n">my_mean</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">blur</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">my_mean</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
            <span class="n">population</span> <span class="o">=</span> <span class="n">kernel_size</span> <span class="o">*</span> <span class="n">kernel_size</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">population</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="threshold_nlargest"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.threshold_nlargest">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">threshold_nlargest</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determines the n largest values in image.</span>
<span class="sd">    Returns an image where pixels &gt;= the min(nlargest)</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        n: n largest values from the source image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="c1"># make it flat and convert to set</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>

            <span class="c1"># find n largest, get the min, perform a threshold on the min</span>
            <span class="n">largest</span> <span class="o">=</span> <span class="n">heapq</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">vector</span><span class="p">)</span>

            <span class="n">threshold</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">largest</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mf">1.0</span>

            <span class="n">retval</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_TOZERO</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="threshold_nlargest_float"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.threshold_nlargest_float">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">threshold_nlargest_float</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determines the n largest float values in image.</span>
<span class="sd">    Returns an image where pixels &gt;= the min(nlargest)</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        n: n largest values from the source image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="c1"># make it flat and convert to set</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>

            <span class="c1"># find n largest, get the min, perform a threshold on the min</span>
            <span class="n">largest</span> <span class="o">=</span> <span class="n">heapq</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">vector</span><span class="p">)</span>

            <span class="n">threshold</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">largest</span><span class="p">)</span>
            <span class="p">(</span><span class="n">data_max_x</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">data_max_x</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="threshold_nlargest_binary"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.threshold_nlargest_binary">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">threshold_nlargest_binary</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determines the n largest binary values in image.</span>
<span class="sd">    Returns an image where pixels &gt;= the min(nlargest)</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        n: n largest values from the source image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="c1"># make it flat and convert to set</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>

            <span class="c1"># find n largest, get the min, perform a threshold on the min</span>
            <span class="n">largest</span> <span class="o">=</span> <span class="n">heapq</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">vector</span><span class="p">)</span>

            <span class="n">threshold</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">largest</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">:</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mi">255</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">maxvalue</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">retval</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">maxvalue</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">THRESH_BINARY</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="threshold_nlargest_binary_float"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.threshold_nlargest_binary_float">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">threshold_nlargest_binary_float</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">maxvalue</span><span class="o">=</span><span class="mi">255</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Determines the n largest binary float values in image.</span>
<span class="sd">    Returns an image where pixels &gt;= the min(nlargest)</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        n: n largest values from the source image</span>
<span class="sd">        maxvalue: maximum value</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="c1"># make it flat and convert to set</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">vector</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>

            <span class="c1"># find n largest, get the min, perform a threshold on the min</span>
            <span class="n">largest</span> <span class="o">=</span> <span class="n">heapq</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">vector</span><span class="p">)</span>

            <span class="n">threshold</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">largest</span><span class="p">)</span>
            <span class="p">(</span><span class="n">data_max_x</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">data_max_x</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">maxvalue</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<span class="c1"># do not include in gp_framework_helper</span>
<div class="viewcode-block" id="nlargest"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.nlargest">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">nlargest</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a list of the n highest amplitudes in the data_pair</span>

<span class="sd">    TODO - returns list</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        n: the number of values to return</span>

<span class="sd">    Returns:</span>
<span class="sd">        [ [n largest training data], [nlargest test data] ]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="c1"># make it flat</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="c1"># convert to set</span>
            <span class="n">img</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">largest</span> <span class="o">=</span> <span class="n">heapq</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
            <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">largest</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data_list</span></div>


<div class="viewcode-block" id="scale_abs"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.scale_abs">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">scale_abs</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Scales, calculates absolute values, and converts the result to 8-bit</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        alpha: scale factor</span>
<span class="sd">        beta: delta added to the scaled values</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">convertScaleAbs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="get_data_items"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.get_data_items">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">get_data_items</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the data items in a list from the data_pair</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data_list</span></div>

<span class="c1"># contour helper functions</span>

<span class="c1">#do not include in gp_framework_helper</span>
<div class="viewcode-block" id="get_circular_extent"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.get_circular_extent">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">get_circular_extent</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">contour</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the ratio of occupied pixels to circle area</span>

<span class="sd">    Args:</span>
<span class="sd">        img: this needs to be the original image</span>
<span class="sd">        contour: contour</span>

<span class="sd">    Returns:</span>
<span class="sd">        extent float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">drawn_contours</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">drawn_contours</span><span class="p">,</span> <span class="n">contour</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># draw a filled circle around the contour</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">minEnclosingCircle</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>
    <span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
    <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">total_area</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">countNonZero</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>

    <span class="c1"># mask the original image with the contour image</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">drawn_contours</span><span class="p">)</span>
    <span class="n">object_area</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">countNonZero</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">object_area</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_area</span></div>


<span class="c1">#do not include in gp_framework_helper</span>
<div class="viewcode-block" id="aspect_ratio"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.aspect_ratio">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">aspect_ratio</span><span class="p">(</span><span class="n">contour</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the aspect ratio width/height of the contour</span>

<span class="sd">    Args:</span>
<span class="sd">        contour: contour</span>

<span class="sd">    Returns:</span>
<span class="sd">        aspect ratio float</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.01</span><span class="o">*</span><span class="n">cv2</span><span class="o">.</span><span class="n">arcLength</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span><span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">approx</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">approxPolyDP</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span><span class="n">epsilon</span><span class="p">,</span><span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>
    <span class="n">aspect</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">/</span> <span class="n">h</span>
    <span class="k">return</span> <span class="n">aspect</span></div>


<span class="c1">#do not include in gp_framework_helper</span>
<div class="viewcode-block" id="extent"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.extent">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">extent</span><span class="p">(</span><span class="n">contour</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extent is the ratio of contour area to bounding rectangle area</span>

<span class="sd">    Args:</span>
<span class="sd">        contour: contour</span>

<span class="sd">    Returns:</span>
<span class="sd">        float ratio of object area to bounding rectangle area</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">area</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">cv2</span><span class="o">.</span><span class="n">arcLength</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span><span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">approx</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">approxPolyDP</span><span class="p">(</span><span class="n">contour</span><span class="p">,</span><span class="n">epsilon</span><span class="p">,</span><span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">(</span><span class="n">approx</span><span class="p">)</span>
    <span class="n">rect_area</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">h</span>
    <span class="n">e</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">area</span><span class="p">)</span> <span class="o">/</span> <span class="n">rect_area</span>
    <span class="k">return</span> <span class="n">e</span></div>


<span class="c1">#do not include in gp_framework_helper</span>
<div class="viewcode-block" id="solidity"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.solidity">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">solidity</span><span class="p">(</span><span class="n">contour</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Solidity is the ratio of contour area to its convex hull area</span>

<span class="sd">    Args:</span>
<span class="sd">        contour: contour</span>

<span class="sd">    Returns:</span>
<span class="sd">        solidity</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">area</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>
    <span class="n">hull</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">convexHull</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>
    <span class="n">hull_area</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">hull</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">area</span><span class="p">)</span> <span class="o">/</span> <span class="n">hull_area</span>
    <span class="k">return</span> <span class="n">s</span></div>


<span class="c1">#do not include in gp_framework_helper</span>
<div class="viewcode-block" id="equ_diameter"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.equ_diameter">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">equ_diameter</span><span class="p">(</span><span class="n">contour</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the equ_diameter</span>

<span class="sd">    Args:</span>
<span class="sd">        contour: contour</span>

<span class="sd">    Returns:</span>
<span class="sd">        equ_diameter</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">area</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">contour</span><span class="p">)</span>
    <span class="n">equi_diameter</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">area</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">equi_diameter</span></div>


<span class="c1"># contours</span>

<span class="c1"># do not include in gp_framework_helper</span>
<div class="viewcode-block" id="get_contours"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.get_contours">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">get_contours</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns ndarray of contours</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contours</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data_list</span></div>


<div class="viewcode-block" id="contours_all"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contours_all">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contours_all</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="c1">#todo see if this is in the test suite</span>
    <span class="sd">&quot;&quot;&quot;Finds all contours in the image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contours_min_area"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contours_min_area">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contours_min_area</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Finds all contours that have min area or more</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        area: uint8,float minimum area</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">area</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># contours are drawn with max value 255 therefor all bits set</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contours_max_area"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contours_max_area">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contours_max_area</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns image with all contours that have an area &lt;= area</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        area: area to compare</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">area</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># contours are drawn with max value 255 therefor all bits set</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contours_convex_concave"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contours_convex_concave">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contours_convex_concave</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">convex</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns an image of contours if the contour is convex when convex=True.</span>
<span class="sd">    When convex=False it will return the concave contours</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        convex: bool True returns convex contours, false returns</span>
<span class="sd">        concave contours</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair, image of convex or concave contours</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">convex</span><span class="p">:</span>
                <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">isContourConvex</span><span class="p">(</span><span class="n">c</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">cv2</span><span class="o">.</span><span class="n">isContourConvex</span><span class="p">(</span><span class="n">c</span><span class="p">)]</span>

            <span class="c1"># create mask to return just the contours that meet the</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># contours are drawn with max value 255 therefor all bits set</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contours_min_length"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contours_min_length">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contours_min_length</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns an image of contours if the contours arc length &gt;= length</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        length: int / float minimum length of contours to include in the</span>
<span class="sd">        output image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">arcLength</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">length</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># contours are drawn with max value 255 therefor all bits set</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contours_max_length"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contours_max_length">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contours_max_length</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns an image of contours if the contours arc length &lt;= length</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        length: int / float minimum length of contours to include in the</span>
<span class="sd">        output image</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">arcLength</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">length</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="c1"># contours are drawn with max value 255 therefor all bits set</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<span class="c1"># contour masks</span>

<div class="viewcode-block" id="contour_mask"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;RFinds the contours in an image, fills in the contours, returns an</span>
<span class="sd">    image suitable for a mask</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">cont</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cont</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_min_area"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_min_area">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_min_area</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a mask of all contours that have an area &gt;= area</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        area: int / float</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">area</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_max_area"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_max_area">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_max_area</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a mask of all contours that have an area &lt;= area</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        area: int / float</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">area</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_convex"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_convex">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_convex</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">convex</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns an image of contours if the contour is convex when convex=True.</span>
<span class="sd">    When convex=False it will return the concave contours</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        convex: bool True returns convex contours, false returns</span>
<span class="sd">        concave contours</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">convex</span><span class="p">:</span>
                <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">isContourConvex</span><span class="p">(</span><span class="n">c</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">cv2</span><span class="o">.</span><span class="n">isContourConvex</span><span class="p">(</span><span class="n">c</span><span class="p">)]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_min_length"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_min_length">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_min_length</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a mask of all contours that have an arc length &gt;= length</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        length: int / float</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">length</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_max_length"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_max_length">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_max_length</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a mask of all contours that have an arc length &gt;= length</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        length: int / float</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">length</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_range_length"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_range_length">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_range_length</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a mask of all contours that have an arc length &gt;= lower_bound</span>
<span class="sd">    and &lt;= upper_bound</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        lower_bound: lower bound</span>
<span class="sd">        upper_bound: upper bound</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">lower_bound</span> <span class="o">&lt;=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">upper_bound</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_min_enclosing_circle"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_min_enclosing_circle">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_min_enclosing_circle</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a mask of all contours that have a minimum enclosing</span>
<span class="sd">    circle area &gt;= area</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        area: minimum area of contours</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">area</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_max_enclosing_circle"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_max_enclosing_circle">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_max_enclosing_circle</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a mask of all contours that have a minimum enclosing</span>
<span class="sd">    circle area &lt;= area</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        area: minimum area of contours</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">area</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_range_enclosing_circle"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_range_enclosing_circle">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_range_enclosing_circle</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns mask of all contours that have an area &gt;= lower_bound and area &lt;= upper_bound</span>
<span class="sd">    circle area &gt;= area</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        lower_bound: float / int</span>
<span class="sd">        upper_bound: float / int</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">lower_bound</span> <span class="o">&lt;=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">contourArea</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">upper_bound</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_min_extent_enclosing_circle"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_min_extent_enclosing_circle">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_min_extent_enclosing_circle</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the ratio of occupied pixels in the original image to the</span>
<span class="sd">    number of pixels in minim enclosing circle of each contour.</span>

<span class="sd">    The mask returned has objects that are &gt;= ratio in extent</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        ratio: ratio for comparison</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">org</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">get_circular_extent</span><span class="p">(</span><span class="n">org</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">ratio</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the ratio requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_max_extent_enclosing_circle"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_max_extent_enclosing_circle">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_max_extent_enclosing_circle</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the ratio of occupied pixels in the original image to the</span>
<span class="sd">    number of pixels in minim enclosing circle of each contour.</span>

<span class="sd">    The mask returned has objects that are &lt;= ratio in extent</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        ratio: ratio for comparison</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">org</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">get_circular_extent</span><span class="p">(</span><span class="n">org</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ratio</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the ratio requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_range_extent_enclosing_circle"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_range_extent_enclosing_circle">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_range_extent_enclosing_circle</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates the ratio of occupied pixels in the original image to the</span>
<span class="sd">    number of pixels in minim enclosing circle of each contour.</span>

<span class="sd">    The mask returned has objects are &gt;= lower_bound and &lt;= upper_bound</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        lower_bound: lower bound</span>
<span class="sd">        upper_bound: upper bound</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">org</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">get_circular_extent</span><span class="p">(</span><span class="n">org</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">lower_bound</span> <span class="ow">and</span>
                        <span class="n">get_circular_extent</span><span class="p">(</span><span class="n">org</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">upper_bound</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the ratio requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_min_aspect_ratio"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_min_aspect_ratio">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_min_aspect_ratio</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a mask of all contours that have an aspect ratio &gt;= ratio</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        ratio: ratio for comparison</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">aspect_ratio</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">ratio</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_max_aspect_ratio"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_max_aspect_ratio">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_max_aspect_ratio</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">ratio</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a mask of all contours that have an aspect ratio &lt;= ratio</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        ratio: ratio for comparison</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">aspect_ratio</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ratio</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_range_aspect_ratio"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_range_aspect_ratio">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_range_aspect_ratio</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a mask of all contours that have an aspect ratio &gt;= lower_bound and &lt;= upper_bound</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        lower_bound: lower bound</span>
<span class="sd">        upper_bound: upper bound</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">lower_bound</span> <span class="o">&lt;=</span> <span class="n">aspect_ratio</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">upper_bound</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_min_extent"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_min_extent">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_min_extent</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ratio of the contour area to the bounding rectangle area</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        boundary: mask will return contours &gt;= boundary in extent</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">extent</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">boundary</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_max_extent"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_max_extent">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_max_extent</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a mask of all contours that have an extent &gt;= ratio.</span>

<span class="sd">    Extent is the ratio of object area to bounding</span>
<span class="sd">    rectangle area.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        boundary: mask will return contours &lt;= boundary in extent</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">extent</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">boundary</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_range_extent"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_range_extent">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_range_extent</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a mask of all contours that have an aspect ratio</span>
<span class="sd">    &gt;= lower_bound and &lt;= upper_bound</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        lower_bound: lower bound</span>
<span class="sd">        upper_bound: upper bound</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">lower_bound</span> <span class="o">&lt;=</span> <span class="n">extent</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">upper_bound</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_min_solidity"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_min_solidity">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_min_solidity</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="mi">128</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Solidity is the ratio of contour area to its convex hull area</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        boundary: mask will return contours &gt;= boundary in extent</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">solidity</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">boundary</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_max_solidity"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_max_solidity">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_max_solidity</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Solidity is the ratio of contour area to its convex hull area</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair, input image</span>
<span class="sd">        boundary: int / float</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair, mask</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">solidity</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">boundary</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_range_solidity"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_range_solidity">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_range_solidity</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Solidity is the ratio of contour area to its convex hull area</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        lower_bound: lower bound</span>
<span class="sd">        upper_bound: upper bound</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">lower_bound</span> <span class="o">&lt;=</span> <span class="n">solidity</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">upper_bound</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_min_equ_diameter"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_min_equ_diameter">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_min_equ_diameter</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Equivalent Diameter is the diameter of the circle whose area is same as the contour area</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        boundary: mask will return contours &gt;= boundary in extent</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">equ_diameter</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">boundary</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_max_equ_diameter"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_max_equ_diameter">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_max_equ_diameter</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Equivalent Diameter is the diameter of the circle whose area is same as the contour area</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair, input image</span>
<span class="sd">        boundary: int / float</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair, mask</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">equ_diameter</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">boundary</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="contour_mask_range_equ_diameter"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.contour_mask_range_equ_diameter">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">contour_mask_range_equ_diameter</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">lower_bound</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">upper_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Equivalent Diameter is the diameter of the circle whose area is same as the contour area</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        lower_bound: lower bound</span>
<span class="sd">        upper_bound: upper bound</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_NONE</span><span class="p">)</span>
            <span class="n">contours</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">contours</span> <span class="k">if</span> <span class="n">lower_bound</span> <span class="o">&lt;=</span> <span class="n">equ_diameter</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">upper_bound</span><span class="p">]</span>

            <span class="c1"># create mask to return just the contours that meet the area requirement</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">drawContours</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<span class="c1"># functions that return lists - TODO need to find some way to make their return values work in the data_pair scheme</span>
<div class="viewcode-block" id="mean"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.mean">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="c1"># TODO change the way values are returned</span>
    <span class="sd">&quot;&quot;&quot;Calculates the mean</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        [mean, mean]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">m</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data_list</span></div>


<div class="viewcode-block" id="my_sum"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.my_sum">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">my_sum</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="c1"># TODO change the way values are returned</span>
    <span class="sd">&quot;&quot;&quot;Calculates the sum of array elements</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        [sum, sum]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">summation</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">summation</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">sumElems</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">summation</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data_list</span></div>


<div class="viewcode-block" id="correlation"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.correlation">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">correlation</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">second_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns data where data_out[x][y] = 0 if data[x][y] &gt; alpha</span>
<span class="sd">    * second_data[x][y] else data_out[x][y] = data[x][y]</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        second_pair: given datapair</span>
<span class="sd">        alpha: scaling factor</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">second_data</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">correlate2d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">second_data</span><span class="p">,</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<span class="c1"># do not include in gp_framwork_helper</span>
<div class="viewcode-block" id="min_max_loc"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.min_max_loc">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">min_max_loc</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Finds the minimum, maximum and their location</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        [min, min] [max, max] [min location, min location] [max location, max location]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">my_minimum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">my_maximum</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">min_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">max_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">min_location</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">max_location</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">min_location_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">max_location_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">my_minimum</span><span class="p">,</span> <span class="n">my_maximum</span><span class="p">,</span> <span class="n">min_location</span><span class="p">,</span> <span class="n">max_location</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">minMaxLoc</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">min_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">my_minimum</span><span class="p">)</span>
        <span class="n">max_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">my_maximum</span><span class="p">)</span>
        <span class="n">min_location_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">min_location</span><span class="p">)</span>
        <span class="n">max_location_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_location</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">min_list</span><span class="p">,</span> <span class="n">max_list</span><span class="p">,</span> <span class="n">min_location_list</span><span class="p">,</span> <span class="n">max_location_list</span></div>


<span class="c1"># do not include in gp_framework_helper</span>
<div class="viewcode-block" id="scalar_pixel_sum"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.scalar_pixel_sum">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">scalar_pixel_sum</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;TODO</span>

<span class="sd">    Sums each pixel in the image</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">    Returns:</span>
<span class="sd">        list of int</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sum_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span><span class="s2">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span>
            <span class="n">summation</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sum</span>
            <span class="n">sum_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">summation</span><span class="p">)</span>
            <span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span><span class="s2">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">sum_list</span></div>

<span class="c1"># functions for the dual color algorithm</span>


<span class="c1"># do not include in gp_framework_helper</span>
<div class="viewcode-block" id="get_image_sample"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.get_image_sample">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">get_image_sample</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">hole_size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a kernel_size x kernel_size np.array of data centered about x,y</span>
<span class="sd">    The data is set to zero for the items within hole_size centered about x,y</span>

<span class="sd">    Args:</span>
<span class="sd">        data: 2 dimensional numpy array</span>
<span class="sd">        x: x index</span>
<span class="sd">        y: y index</span>
<span class="sd">        kernel_size: size of kernel</span>
<span class="sd">        hole_size: size of the hole</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create a destination for the median data</span>
    <span class="n">sampled_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

    <span class="c1"># get half of the kernel size - kernel is an odd integer in length, int division will return int</span>
    <span class="n">kernel_size</span> <span class="o">/=</span> <span class="mi">2</span>
    <span class="n">hole_size</span> <span class="o">/=</span> <span class="mi">2</span>

    <span class="c1"># get data dimensions - the value returned is the length not the max index</span>
    <span class="c1"># max index = data_max - 1</span>
    <span class="p">(</span><span class="n">data_max_x</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">data_max_x</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">data_max_y</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">samplex</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">kernel_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">sampley</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">kernel_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1"># dont sample in the hole</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">hole_size</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">hole_size</span><span class="p">:</span>
                <span class="c1"># use reflection if the kernel window extends beyond the boundry of the image</span>

                <span class="k">if</span> <span class="n">x</span><span class="o">+</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">index_x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">x</span><span class="o">+</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">data_max_x</span><span class="p">:</span>
                    <span class="n">index_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">kernel_size</span><span class="o">*</span><span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">index_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">i</span>

                <span class="k">if</span> <span class="n">y</span><span class="o">+</span><span class="n">j</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">index_y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">y</span><span class="o">+</span><span class="n">j</span> <span class="o">&gt;</span> <span class="n">data_max_y</span><span class="p">:</span>
                    <span class="n">index_y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">kernel_size</span><span class="o">*</span><span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">index_y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">j</span>

                <span class="n">sampled_data</span><span class="p">[</span><span class="n">samplex</span><span class="p">][</span><span class="n">sampley</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">index_x</span><span class="p">][</span><span class="n">index_y</span><span class="p">]</span>
            <span class="n">sampley</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">samplex</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">sampled_data</span></div>


<span class="c1"># do not include this function in the GPFramework function list</span>
<div class="viewcode-block" id="get_image_values"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.get_image_values">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">get_image_values</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">hole_size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns a numpy array of the pixel values not within the hole</span>

<span class="sd">    Args:</span>
<span class="sd">        data: 2 dimensional numpy array</span>
<span class="sd">        x: x offset into the array</span>
<span class="sd">        y: y offset into the array</span>
<span class="sd">        kernel_size: size of the convolutional kernel</span>
<span class="sd">        hole_size: size of the hole to not sample from</span>

<span class="sd">    Returns:</span>
<span class="sd">        list</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kernel_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>
    <span class="n">hole_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">hole_size</span><span class="p">)</span>

    <span class="c1"># create a destination for the data</span>
    <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># get half of the kernel size - kernel is an odd integer in length, int division will return int</span>
    <span class="n">kernel_size</span> <span class="o">/=</span> <span class="mi">2</span>
    <span class="n">hole_size</span> <span class="o">/=</span> <span class="mi">2</span>

    <span class="c1"># get data dimensions - the value returned is the length not the max index</span>
    <span class="c1"># max index = data_max - 1</span>
    <span class="p">(</span><span class="n">data_max_x</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">data_max_x</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="n">data_max_y</span> <span class="o">-=</span> <span class="mi">1</span>



    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">kernel_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">kernel_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1"># dont sample in the hole</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">hole_size</span> <span class="ow">or</span> <span class="nb">abs</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">hole_size</span><span class="p">:</span>
                <span class="c1"># use reflection if the kernel window extends beyond the boundry of the image</span>

                <span class="k">if</span> <span class="n">x</span><span class="o">+</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">index_x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">x</span><span class="o">+</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">data_max_x</span><span class="p">:</span>
                    <span class="n">index_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">kernel_size</span><span class="o">*</span><span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">index_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">i</span>

                <span class="k">if</span> <span class="n">y</span><span class="o">+</span><span class="n">j</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">index_y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">y</span><span class="o">+</span><span class="n">j</span> <span class="o">&gt;</span> <span class="n">data_max_y</span><span class="p">:</span>
                    <span class="n">index_y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">kernel_size</span><span class="o">*</span><span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">index_y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">j</span>

                <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">index_x</span><span class="p">][</span><span class="n">index_y</span><span class="p">])</span>
    <span class="nb">list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">list</span></div>


<div class="viewcode-block" id="not_in_the_hole"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.not_in_the_hole">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">not_in_the_hole</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">hole_size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns true if x, y are not in the hole, else returns false</span>

<span class="sd">    Args:</span>
<span class="sd">        data: 2 dimensional numpy array</span>
<span class="sd">        x: x index</span>
<span class="sd">        y: y index</span>
<span class="sd">        kernel_size: size of kernel</span>
<span class="sd">        hole_size: size of the hole</span>

<span class="sd">    Returns:</span>
<span class="sd">        Boolean</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get half of the kernel size - kernel is an odd integer in length, int division will return int</span>
    <span class="n">k</span><span class="o">=</span> <span class="n">kernel_size</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">h</span><span class="o">=</span> <span class="n">hole_size</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="n">hole_min</span> <span class="o">=</span> <span class="n">k</span><span class="o">-</span><span class="n">h</span>
    <span class="n">hole_max</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="n">h</span>

    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">hole_min</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">hole_max</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="n">hole_min</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="n">hole_max</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="median_filter_hole"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.median_filter_hole">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">median_filter_hole</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">hole_size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Median filter with a hole in the middle that is not included in the</span>
<span class="sd">    median calculation</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_size: size of kernel window</span>
<span class="sd">        hole_size: size of the window to exclude from the calculation</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="c1"># create a destination for the median data</span>
            <span class="n">median_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

            <span class="c1"># get half of the kernel size - kernel is an odd integer in length, int division will return int</span>
            <span class="n">kernel_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>
            <span class="n">hole_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">hole_size</span><span class="p">)</span>

            <span class="c1"># get data dimensions - the value returned is the length not the max index</span>
            <span class="c1"># max index = data_max - 1</span>
            <span class="p">(</span><span class="n">data_max_x</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>

            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_x</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">):</span>
                    <span class="c1"># get a kernel_size x kernel_size sample of the data centered around x,y</span>
                    <span class="c1"># with any values within the hole_size set = 0</span>
                    <span class="n">sample</span> <span class="o">=</span> <span class="n">get_image_sample</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">,</span> <span class="n">hole_size</span><span class="p">)</span>

                    <span class="c1"># get only samples that are not in the hole</span>
                    <span class="n">sample_list</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">kernel_size</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">kernel_size</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">not_in_the_hole</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">kernel_size</span><span class="p">,</span><span class="n">hole_size</span><span class="p">):</span>
                                <span class="n">sample_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">sample_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="n">median</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">sample_list</span><span class="p">)</span>
                    <span class="c1"># assign the median to the center pixel in the new image</span>
                    <span class="n">median_data</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">median</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">median_data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="spectral_filter"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.spectral_filter">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">spectral_filter</span><span class="p">(</span><span class="n">spatial_primary_pair</span><span class="p">,</span> <span class="n">spatial_reference_pair</span><span class="p">,</span> <span class="n">pr_primary_pair</span><span class="p">,</span> <span class="n">pr_reference_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Spectral filter images for a dual color algorithm</span>

<span class="sd">    S(x) = spatially filtered image</span>
<span class="sd">    P(x) = Pre Rejection filtered image</span>
<span class="sd">    P = Primary image</span>
<span class="sd">    R = Reference image</span>

<span class="sd">    a = CORR(P(P), P(R)) / CORR(P(R),P(R))</span>

<span class="sd">    out = S(P) - aS(R)</span>

<span class="sd">    Args:</span>
<span class="sd">        spatial_primary_pair: Spatially filtered primary image data pair</span>
<span class="sd">        spectral_reference_pair: Spatially filtered reference image data pair</span>
<span class="sd">        pr_primary_pair: Pre Rejection filtered Primary image data pair</span>
<span class="sd">        pr_reference_pair: Pre Rejection filtered reference image data pair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">spatial_primary_data_set</span><span class="p">,</span> <span class="n">spatial_reference_set</span><span class="p">,</span> <span class="n">pr_primary_set</span><span class="p">,</span> <span class="n">pr_reference_set</span> <span class="ow">in</span> \
            <span class="nb">zip</span><span class="p">([</span><span class="n">spatial_primary_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">spatial_primary_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                     <span class="p">[</span><span class="n">spatial_reference_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">spatial_reference_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                     <span class="p">[</span><span class="n">pr_primary_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">pr_primary_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                     <span class="p">[</span><span class="n">pr_reference_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">pr_reference_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>

        <span class="n">spp_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">spatial_primary_data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">srp_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">spatial_reference_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">prp_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">pr_primary_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">prr_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">pr_reference_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">spp_instance</span><span class="p">,</span> <span class="n">srp_instance</span><span class="p">,</span> <span class="n">prp_instance</span><span class="p">,</span> <span class="n">prr_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">spp_instances</span><span class="p">,</span> <span class="n">srp_instances</span><span class="p">,</span> <span class="n">prp_instances</span><span class="p">,</span><span class="n">prr_instances</span><span class="p">):</span>
            <span class="n">spp</span> <span class="o">=</span> <span class="n">spp_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">srp</span> <span class="o">=</span> <span class="n">srp_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">prp</span> <span class="o">=</span> <span class="n">prp_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">prr</span> <span class="o">=</span> <span class="n">prr_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">dividend</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">correlate2d</span><span class="p">(</span><span class="n">prp</span><span class="p">,</span> <span class="n">prr</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>
            <span class="n">divisor</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">correlate2d</span><span class="p">(</span><span class="n">prr</span><span class="p">,</span> <span class="n">prr</span><span class="p">,</span> <span class="s1">&#39;same&#39;</span><span class="p">)</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">dividend</span><span class="p">,</span> <span class="n">divisor</span><span class="p">)</span>

            <span class="n">subtrahend</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">srp</span><span class="p">)</span>
            <span class="n">spectral</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">spp</span><span class="p">,</span> <span class="n">subtrahend</span><span class="p">)</span>

            <span class="n">spp_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">spectral</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">spp_instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="std_deviation_hole"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.std_deviation_hole">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">std_deviation_hole</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">hole_size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the standard deviation of the image excluding the pixel values</span>
<span class="sd">    in the hole</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_size: size of kernel window</span>
<span class="sd">        hole_size: size of the window to exclude from the calculation</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="c1"># create a destination for the std_deviation data</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

            <span class="n">kernel_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>
            <span class="n">hole_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">hole_size</span><span class="p">)</span>

            <span class="c1"># get data dimensions - the value returned is the length not the max index</span>
            <span class="c1"># max index = data_max - 1</span>
            <span class="p">(</span><span class="n">data_max_x</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">data_max_index_x</span> <span class="o">=</span> <span class="n">data_max_x</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">data_max_index_y</span> <span class="o">=</span> <span class="n">data_max_y</span> <span class="o">-</span> <span class="mi">1</span>

            <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_x</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">):</span>
                    <span class="c1"># get a kernel_size x kernel_size sample of the data centered around x,y</span>
                    <span class="c1"># with any values within the hole_size set = 0</span>
                    <span class="c1"># sample = get_image_values(data, x, y, kernel_size, hole_size)</span>
                    <span class="n">sample</span> <span class="o">=</span> <span class="n">get_image_sample</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">,</span> <span class="n">hole_size</span><span class="p">)</span>
                    <span class="c1"># get only samples that are not in the hole</span>
                    <span class="n">sample_list</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">kernel_size</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">kernel_size</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">not_in_the_hole</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">hole_size</span><span class="p">):</span>
                                <span class="n">sample_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">sample_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="n">std_deviation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">sample_list</span><span class="p">)</span>
                    <span class="c1"># assign the value to the current pixel in the new image</span>
                    <span class="n">new_data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">std_deviation</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="std_deviation_hole_custom"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.std_deviation_hole_custom">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">std_deviation_hole_custom</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">hole_size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the standard deviation of the image excluding the pixel values</span>
<span class="sd">    in the hole</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_size: size of kernel window</span>
<span class="sd">        hole_size: size of the window to exclude from the calculation</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kernel_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>
    <span class="n">hole_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">hole_size</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>


    <span class="n">second_pair</span> <span class="o">=</span> <span class="n">mean_with_hole</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">,</span> <span class="n">hole_size</span><span class="p">)</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">second_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
                                    <span class="p">[</span><span class="n">second_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">second_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">second_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">second_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">second_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">second_instances</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">image_mean</span> <span class="o">=</span> <span class="n">second_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">image_mean</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
            <span class="n">population</span> <span class="o">=</span> <span class="n">kernel_size</span> <span class="o">*</span> <span class="n">kernel_size</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">population</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="mean_with_hole"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.mean_with_hole">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">mean_with_hole</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">hole_size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the mean of the image excluding the pixel values in the hole</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_size: size of kernel window</span>
<span class="sd">        hole_size: size of the window to exclude from the calculation</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>
            <span class="n">hole_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">hole_size</span><span class="p">)</span>
            <span class="n">kernel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">hole_size</span><span class="p">,</span> <span class="n">hole_size</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

            <span class="c1"># find center</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">kernel_size</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">hole_size</span> <span class="o">/</span> <span class="mi">2</span>

            <span class="n">kernel</span><span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="n">h</span> <span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="n">h</span> <span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="mi">1</span> <span class="p">]</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">hole_size</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">hole_size</span><span class="p">]</span>

            <span class="n">new_data</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">filter2D</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">kernel</span><span class="p">,</span><span class="n">borderType</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">BORDER_REFLECT_101</span><span class="p">)</span>
            <span class="n">cv2</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="n">kernel_size</span> <span class="o">*</span> <span class="n">kernel_size</span><span class="p">,</span> <span class="n">new_data</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="prerejection"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.prerejection">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">prerejection</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">hole_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Prerejection filter for dual color algorithm</span>

<span class="sd">    if pixel std_deviation(data[x,y]) &gt; threshold ---&gt; data[x,y] = 0</span>
<span class="sd">    Replace pixel with 0 if intensity &gt; local stdard deviation by a given factor</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_size: size of kernel for std deviation</span>
<span class="sd">        hole_size: size of the hole for std deviation</span>
<span class="sd">        alpha: scaling factor for std dev comparison</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kernel_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>
    <span class="n">hole_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">hole_size</span><span class="p">)</span>
    <span class="n">std_dev</span> <span class="o">=</span> <span class="n">std_deviation_hole</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">,</span> <span class="n">hole_size</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">set_to_zero_if_greater_than_data_and_factor</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">std_dev</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="rms_hole"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.rms_hole">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">rms_hole</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">hole_size</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the RMS of the image excluding the pixel values in the hole</span>

<span class="sd">    rms = sqrt(blur(I*I) - blur(I)*blur(I))</span>
<span class="sd">    rms = sqrt(avg(I*I) - avg(I)avg(I)</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_size: size of kernel window</span>
<span class="sd">        hole_size: size of the hole to exclude from the calculation</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="c1"># create a destination for the std_deviation data</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

            <span class="c1"># get half of the kernel size - kernel is an odd integer in length, int division will return int</span>
            <span class="n">kernel_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>
            <span class="n">hole_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">hole_size</span><span class="p">)</span>
            <span class="n">kernel_size</span> <span class="o">/=</span> <span class="mi">2</span>
            <span class="n">hole_size</span> <span class="o">/=</span> <span class="mi">2</span>

            <span class="c1"># get data dimensions - the value returned is the length not the max index</span>
            <span class="c1"># max index = data_max - 1</span>
            <span class="p">(</span><span class="n">data_max_x</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>

            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_x</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_y</span><span class="p">):</span>
                    <span class="c1"># get a kernel_size x kernel_size sample of the data centered around x,y</span>
                    <span class="c1"># with any values within the hole_size set = 0</span>
                    <span class="n">sample</span> <span class="o">=</span> <span class="n">get_image_sample</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">,</span> <span class="n">hole_size</span><span class="p">)</span>
                    <span class="c1"># get only samples that are not in the hole</span>
                    <span class="n">sample_list</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">kernel_size</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">kernel_size</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">not_in_the_hole</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">hole_size</span><span class="p">):</span>
                                <span class="n">sample_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sample</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">sample_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                    <span class="n">sample_squared</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">sample_list</span><span class="p">,</span> <span class="n">sample_list</span><span class="p">)</span>
                    <span class="n">mean_sample_squared</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">sample_squared</span><span class="p">)</span>

                    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">sample_list</span><span class="p">)</span>
                    <span class="n">mean_squared</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">*</span> <span class="n">mean</span>

                    <span class="n">difference</span> <span class="o">=</span> <span class="n">mean_sample_squared</span> <span class="o">-</span> <span class="n">mean_squared</span>
                    <span class="n">rms</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">difference</span><span class="p">))</span>

                    <span class="c1"># assign the value to the current pixel in the new image</span>
                    <span class="n">new_data</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">rms</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="mark_targets"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.mark_targets">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">mark_targets</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Consolidate points that fall within kernel_size window to a single point</span>
<span class="sd">    based on its brightness</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        kernel_size: size of kernel window</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mark Targets Get Instance&#39;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">kernel_size</span> <span class="o">=</span> <span class="n">check_kernel_size</span><span class="p">(</span><span class="n">kernel_size</span><span class="p">)</span>

            <span class="c1"># get data dimensions - the value returned is the length not the max index</span>
            <span class="p">(</span><span class="n">data_max_index_x</span><span class="p">,</span> <span class="n">data_max_index_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>

            <span class="c1"># image could have negative numbers</span>
            <span class="n">image_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">image_min</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">image_min</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">image_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mark Targets Before Merge Pixels&#39;</span><span class="p">)</span>
            <span class="c1"># loop over entire image</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_index_x</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_index_y</span><span class="p">):</span>

                    <span class="n">box_max_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">kernel_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">data_max_index_x</span><span class="p">)</span>
                    <span class="n">box_max_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">kernel_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">data_max_index_y</span><span class="p">)</span>
                    <span class="c1"># get a kernel_size x kernel_size sample of the image</span>
                    <span class="n">sample</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">:</span> <span class="n">box_max_x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">box_max_y</span><span class="p">]</span>

                    <span class="c1"># determine if there are any occupied pixels</span>
                    <span class="n">maximum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">maximum</span> <span class="o">&gt;</span> <span class="n">image_min</span><span class="p">:</span>
                        <span class="n">coordinates</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">brightness</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">box_max_x</span><span class="p">):</span>
                            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">box_max_y</span><span class="p">):</span>
                                <span class="c1"># store the x,y coordinates of any pixel whose value = maximum</span>
                                <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">maximum</span><span class="p">:</span>
                                    <span class="n">coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
                                    <span class="n">brightness</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
                                <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">image_min</span>

                        <span class="c1"># calculate centroid for target</span>
                        <span class="n">x_sum</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="n">y_sum</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">for</span> <span class="p">(</span><span class="n">detected_x</span><span class="p">,</span> <span class="n">detected_y</span><span class="p">),</span> <span class="n">bright</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span><span class="n">brightness</span><span class="p">):</span>
                            <span class="n">x_sum</span> <span class="o">+=</span> <span class="n">detected_x</span>
                            <span class="n">y_sum</span> <span class="o">+=</span> <span class="n">detected_y</span>
                            <span class="n">value</span> <span class="o">+=</span> <span class="n">bright</span>
                        <span class="n">centroid_x</span> <span class="o">=</span> <span class="n">x_sum</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
                        <span class="n">centroid_y</span> <span class="o">=</span> <span class="n">y_sum</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
                        <span class="c1"># mark centroid</span>
                        <span class="n">data</span><span class="p">[</span><span class="n">centroid_x</span><span class="p">,</span> <span class="n">centroid_y</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mark Targets After Merge Pixels&#39;</span><span class="p">)</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Something is going on with cv2.rectangle - It will not plot anything past about 1/4 of the width of the image</span>
<span class="sd">            it does do its full height</span>
<span class="sd">            THe manual plot point below does not appear in the image</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mark Targets Before Output Image&#39;</span><span class="p">)</span>
            <span class="n">num_targets</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">output_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_index_x</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_index_y</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">image_min</span><span class="p">:</span>
                        <span class="n">output_image</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span>
                        <span class="c1">#num_targets +=1</span>
                        <span class="c1">#point0 = (max(x - kernel_size/2, 0), max(y - kernel_size/2, 0))</span>
                        <span class="c1">#point1 = (min(x + kernel_size/2, data_max_index_x), min(y + kernel_size/2,data_max_index_y))</span>
                        <span class="c1">#print &#39;box&#39;, point0, point1</span>
                        <span class="c1">#cv2.rectangle(output_image, point0, point1, image_max)</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mark Targets After Output Image&#39;</span><span class="p">)</span>

            <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">output_image</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mark Targets Return New Data Pair&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Data Pair&#39;</span><span class="p">,</span> <span class="nb">repr</span><span class="p">(</span><span class="n">new_data_pair</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>


<div class="viewcode-block" id="get_target_points"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.spatial_methods.get_target_points">[docs]</a><span class="nd">@profile</span>
<span class="k">def</span> <span class="nf">get_target_points</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform fft on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Transformed data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span> <span class="ow">or</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">target_points</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">data_labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="p">(</span><span class="n">data_max_index_x</span><span class="p">,</span> <span class="n">data_max_index_y</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>

            <span class="c1"># image could have negative numbers</span>
            <span class="n">image_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">image_min</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">image_min</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="c1"># loop over entire image</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_index_x</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_max_index_y</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">image_min</span><span class="p">:</span>
                        <span class="n">target_points</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
                        <span class="n">data_labels</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
            <span class="n">target_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">target_points</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">target_points</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">old_features</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">new_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">old_features</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">target_points</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
                <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_labels</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>

                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">data_labels</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span>
                                                 <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_features</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                                                 <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_labels</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
                                                <span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">new_data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">new_data_pair</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Jason Zutty, Austin Dunn, Milind Lingineni, Bhargava Samanthula.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>