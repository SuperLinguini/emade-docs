
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>GPFramework.signal_methods &#8212; EMADE 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for GPFramework.signal_methods</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Programmed by Jason Zutty</span>
<span class="sd">Modified by VIP Team</span>
<span class="sd">Implements a number of signal processing methods for use with deap</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">GPFramework.data</span> <span class="k">import</span> <span class="n">GTMOEPDataInstance</span><span class="p">,</span> <span class="n">GTMOEPData</span><span class="p">,</span> <span class="n">GTMOEPDataPair</span><span class="p">,</span> <span class="n">FeatureData</span><span class="p">,</span> <span class="n">StreamData</span>
<span class="kn">import</span> <span class="nn">copy</span> <span class="k">as</span> <span class="nn">cp</span>
<span class="kn">import</span> <span class="nn">scipy.signal</span>
<span class="kn">import</span> <span class="nn">sklearn.gaussian_process</span>
<span class="kn">import</span> <span class="nn">sklearn.decomposition</span>
<span class="kn">import</span> <span class="nn">sklearn.cluster</span>
<span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="k">import</span> <span class="n">SpectralEmbedding</span>
<span class="kn">import</span> <span class="nn">gc</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">FEATURES_TO_FEATURES</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">STREAM_TO_STREAM</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">STREAM_TO_FEATURES</span> <span class="o">=</span> <span class="mi">2</span>


<div class="viewcode-block" id="makeFeatureFromClass"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.makeFeatureFromClass">[docs]</a><span class="k">def</span> <span class="nf">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Makes class labels into a feature</span>

<span class="sd">    Adds new feature to existing data by appending results from a machine</span>
<span class="sd">    learning algorithm</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        name: name of labels</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with class feature appended</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;makeFeatureFromClass&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="c1"># Only need to perform this on testData, machine learning methods handle training data</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">feature_set</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span>
            <span class="c1"># Testing a copy here as I believe modifying this feature later could be causing a change in the target</span>
            <span class="n">target</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">get_target</span><span class="p">())</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">feature_set</span><span class="o">.</span><span class="n">get_data</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">target</span><span class="p">])))</span>
            <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">feature_set</span><span class="o">.</span><span class="n">get_labels</span><span class="p">(),</span> <span class="n">name</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_data</span><span class="p">))))</span>

            <span class="n">feature_set</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_labels</span><span class="p">)</span>
        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="copy_stream_to_target"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.copy_stream_to_target">[docs]</a><span class="k">def</span> <span class="nf">copy_stream_to_target</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Copies the data in the stream objects to the target value</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;copy_stream_to_target&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="c1"># Initialize where the data will be temporarily stored</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Iterate through train data then test data</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="c1"># Copy the dataSet so as not to destroy original data</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="c1"># Iterate over all points in the dataSet</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="c1"># Capture the data</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="c1"># Set the data over to the taget</span>
            <span class="n">instance</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>


        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="c1"># Build deapDataPair</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="remove_feature"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.remove_feature">[docs]</a><span class="k">def</span> <span class="nf">remove_feature</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">feat_num</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Removes a feature from the data</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        feat_num: id of the feature to remove</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with feature removed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;remove_feature&#39;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="c1"># Only need to perform this on testData, machine learning methods handle training data</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">feature_set</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span>
            <span class="c1"># Remove the feat_num column</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">feature_set</span><span class="o">.</span><span class="n">get_data</span><span class="p">(),</span> <span class="n">feat_num</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

            <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">feature_set</span><span class="o">.</span><span class="n">get_labels</span><span class="p">(),</span> <span class="n">feat_num</span><span class="p">)</span>

            <span class="n">feature_set</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_labels</span><span class="p">)</span>
        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="select_range"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.select_range">[docs]</a><span class="k">def</span> <span class="nf">select_range</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">feat_start</span><span class="p">,</span> <span class="n">feat_stop</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Selects a range of data starting from feature feat_start and</span>
<span class="sd">    stopping before feature feat_stop</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        feat_start: id of feature to start at</span>
<span class="sd">        feat_stop: id of feature to stop at</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair from feature start to feature stop</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;select_range&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="n">feature_set</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span>
            <span class="c1"># select the correct range</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="n">feature_set</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[:,</span> <span class="n">feat_start</span><span class="p">:</span><span class="n">feat_stop</span><span class="p">]</span>
            <span class="n">data_labels</span> <span class="o">=</span> <span class="n">feature_set</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()[</span><span class="n">feat_start</span><span class="p">:</span><span class="n">feat_stop</span><span class="p">]</span>

            <span class="n">feature_set</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_labels</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_concatenate"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_concatenate">[docs]</a><span class="k">def</span> <span class="nf">my_concatenate</span><span class="p">(</span><span class="n">data_pair_1</span><span class="p">,</span> <span class="n">data_pair_2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Concatenate twos dataframes together</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair_1: given datapair</span>
<span class="sd">        data_pair_2: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Concatenated data pair</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize where the data will be temporarily stored</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;concatenate&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="c1"># Iterate through train data then test data</span>
    <span class="k">for</span> <span class="n">data_set_1</span><span class="p">,</span> <span class="n">data_set_2</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">data_pair_1</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair_2</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()),</span>
                                   <span class="p">(</span><span class="n">data_pair_1</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">(),</span> <span class="n">data_pair_2</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">())]:</span>
        <span class="c1"># Copy the dataSet so as not to destroy original data</span>
        <span class="n">instances_1</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set_1</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">instances_2</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set_2</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="c1"># Iterate over all points in the dataSet</span>
        <span class="k">for</span> <span class="n">instance_1</span><span class="p">,</span> <span class="n">instance_2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances_1</span><span class="p">,</span> <span class="n">instances_2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">signal_1</span> <span class="o">=</span> <span class="n">instance_1</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">signal_2</span> <span class="o">=</span> <span class="n">instance_2</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">labels_1</span> <span class="o">=</span> <span class="n">instance_1</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()</span>
                <span class="n">labels_2</span> <span class="o">=</span> <span class="n">instance_2</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">signal_1</span> <span class="o">=</span> <span class="n">instance_1</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">signal_2</span> <span class="o">=</span> <span class="n">instance_2</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">labels_1</span> <span class="o">=</span> <span class="n">instance_1</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()</span>
                <span class="n">labels_2</span> <span class="o">=</span> <span class="n">instance_2</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for concatenation&#39;</span>
                    <span class="p">)</span>
            <span class="c1"># Concatenate the two signals together</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">(</span><span class="n">signal_1</span><span class="p">,</span> <span class="n">signal_2</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">(</span><span class="n">labels_1</span><span class="p">,</span> <span class="n">labels_2</span><span class="p">)</span> <span class="p">)</span>

            <span class="c1"># Rebuild the data in instance 1</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance_1</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance_1</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances_1</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="c1"># Build deapDataPair</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="my_if_then_else"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_if_then_else">[docs]</a><span class="k">def</span> <span class="nf">my_if_then_else</span><span class="p">(</span><span class="n">condition_pair</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">data_pair_1</span><span class="p">,</span> <span class="n">data_pair_2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Consumes three data_pairs. Based upon the truth of the target feature in</span>
<span class="sd">    condition_pair, choose correct rows from data_pair_1 and data_pair_2.</span>

<span class="sd">    Args:</span>
<span class="sd">        condition_pair: given condition pair</span>
<span class="sd">        column: column number</span>
<span class="sd">        data_pair_1: given data pair</span>
<span class="sd">        data_pair_2: given data pair</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with added if then else feature</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert column to an int</span>
    <span class="n">column</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
    <span class="c1"># Check that lengths match</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;if_then_else&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="c1"># Initialize output list of instances to empty</span>
    <span class="n">train_output_instances</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">test_output_instances</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># First process train data</span>
    <span class="k">for</span> <span class="n">condition_instance</span><span class="p">,</span> <span class="n">instance_1</span><span class="p">,</span> <span class="n">instance_2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">condition_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span>
            <span class="n">data_pair_1</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span>
            <span class="n">data_pair_2</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()):</span>
        <span class="c1"># Select the proper test column from the condition instance</span>
        <span class="c1"># And choose the proper row for output</span>
        <span class="k">if</span> <span class="n">condition_instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="p">]:</span>
            <span class="n">train_output_instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">instance_1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">train_output_instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">instance_2</span><span class="p">)</span>

    <span class="c1"># Next process process test data</span>
    <span class="k">for</span> <span class="n">condition_instance</span><span class="p">,</span> <span class="n">instance_1</span><span class="p">,</span> <span class="n">instance_2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">condition_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span>
            <span class="n">data_pair_1</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span>
            <span class="n">data_pair_2</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">condition_instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="p">]:</span>
            <span class="n">test_output_instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">instance_1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">test_output_instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">instance_2</span><span class="p">)</span>

    <span class="n">output_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">GTMOEPData</span><span class="p">(</span><span class="n">train_output_instances</span><span class="p">),</span>
                                 <span class="n">test_data</span><span class="o">=</span><span class="n">GTMOEPData</span><span class="p">(</span><span class="n">test_output_instances</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">output_pair</span></div>


<div class="viewcode-block" id="my_averager"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_averager">[docs]</a><span class="k">def</span> <span class="nf">my_averager</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs an averager of length window (Low Pass Filter) on data</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        window: length of window</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with averager feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;averager&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">window</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">window</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># Initialize where the data will be temporarily stored</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Iterate through train data then test data</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="c1"># Copy the dataSet so as not to destroy original data</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="c1"># Iterate over all points in the dataSet</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Averager window&#39;</span>
                    <span class="p">)</span>
            <span class="c1"># Generate kernel</span>
            <span class="n">kern</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
            <span class="n">kern</span> <span class="o">=</span> <span class="n">kern</span> <span class="o">/</span> <span class="nb">float</span><span class="p">((</span><span class="n">window</span><span class="p">))</span>
            <span class="c1"># Perform the convolution</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">new_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">kern</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="c1"># Build deapDataPair</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="my_diff"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_diff">[docs]</a><span class="k">def</span> <span class="nf">my_diff</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs a diff (High Pass Filter) on data</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with diff feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize where the data will be temporarily stored</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;diff&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="c1"># Iterate through train data then test data</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="c1"># Copy the dataSet so as not to destroy original data</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="c1"># Iterate over all points in the dataSet</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Diff&#39;</span>
                    <span class="p">)</span>
            <span class="c1"># Generate kernel</span>
            <span class="n">kern</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">])</span>
            <span class="c1"># Perform the convolution</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">new_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">kern</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;same&#39;</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="c1"># Build deapDataPair</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_auto_corr"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_auto_corr">[docs]</a><span class="k">def</span> <span class="nf">my_auto_corr</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the autocorrelation using the Wiener-Khinchin Theorem</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with autocorrelation feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize where the data will be temporarily stored</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;auto_corr&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="c1"># Iterate through train data then test data</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="c1"># Copy the dataSet so as not to destroy original data</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="c1"># Iterate over all points in the dataSet</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Auto Corr&#39;</span>
                    <span class="p">)</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="o">*</span><span class="n">F</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="c1"># Build deapDataPair</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_cross_corr"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_cross_corr">[docs]</a><span class="k">def</span> <span class="nf">my_cross_corr</span><span class="p">(</span><span class="n">data_pair_1</span><span class="p">,</span> <span class="n">data_pair_2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the cross correlation of two signals</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair_1: given datapair</span>
<span class="sd">        data_pair_2: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with cross correlation feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialize where the data will be temporarily stored</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cross_corr&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="c1"># Iterate through train data then test data</span>
    <span class="k">for</span> <span class="n">data_set_1</span><span class="p">,</span> <span class="n">data_set_2</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">data_pair_1</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair_2</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()),</span>
                                   <span class="p">(</span><span class="n">data_pair_1</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">(),</span> <span class="n">data_pair_2</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">())]:</span>
        <span class="c1"># Copy the dataSet so as not to destroy original data</span>
        <span class="n">instances_1</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set_1</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">instances_2</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set_2</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="c1"># Iterate over all points in the dataSet</span>
        <span class="k">for</span> <span class="n">instance_1</span><span class="p">,</span> <span class="n">instance_2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances_1</span><span class="p">,</span> <span class="n">instances_2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">signal_1</span> <span class="o">=</span> <span class="n">instance_1</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">signal_2</span> <span class="o">=</span> <span class="n">instance_2</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">signal_1</span> <span class="o">=</span> <span class="n">instance_1</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">signal_2</span> <span class="o">=</span> <span class="n">instance_2</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Cross Corr&#39;</span>
                    <span class="p">)</span>
            <span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">signal_1</span><span class="p">)</span>
            <span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">signal_2</span><span class="p">)</span>
            <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="o">*</span><span class="n">G</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance_1</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance_1</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances_1</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="c1"># Build deapDataPair</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="my_dct"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_dct">[docs]</a><span class="k">def</span> <span class="nf">my_dct</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs the discrete cosine transform of a signal x</span>
<span class="sd">    transform can be 1,2, or 3. norm can be None or ortho.</span>

<span class="sd">    http://docs.scipy.org/doc/scipy-0.13.0/reference/generated/scipy.fftpack.dct.html</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        transform: type of dct</span>
<span class="sd">        norm: normalization mode</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with dct feature added</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dct&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="c1"># There are 3 DCT modes: 1, 2, and 3, so let&#39;s mod by 3 and add 1</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">transform</span><span class="o">%</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="c1"># There are two norms ortho or none, so mod them</span>
    <span class="n">norms</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;ortho&#39;</span><span class="p">]</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">norms</span><span class="p">[</span><span class="n">norm</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">norms</span><span class="p">)]</span>

    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span> <span class="ow">or</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">fftpack</span><span class="o">.</span><span class="n">dct</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">old_features</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">new_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">old_features</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
                <span class="c1">#data_labels = np.arange(0, 2*np.pi, 2*np.pi/len(data))</span>
                <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_labels</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>
                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                                         <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">(),</span>
                                         <span class="n">data_labels</span>
                                        <span class="p">))</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span>
                                                 <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_features</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                                                 <span class="n">labels</span><span class="o">=</span><span class="n">new_labels</span>
                                                <span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_hann"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_hann">[docs]</a><span class="k">def</span> <span class="nf">window_hann</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">lag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs a Hann (Hanning) window on a signal with or without &quot;lag&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        lag: whether to include lag</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with Hann window feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window hann&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Hann window&#39;</span>
                    <span class="p">)</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">lag</span><span class="p">:</span>
                <span class="n">w</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">w</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="c1">#print instance</span>
        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_hamming"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_hamming">[docs]</a><span class="k">def</span> <span class="nf">window_hamming</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">lag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perfroms a Hamming window on a signal with or without &quot;lag&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        lag: whether to include lag</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with Hamming window feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window hamming&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Hamming window&#39;</span>
                    <span class="p">)</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.53836</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="mf">0.46164</span>
            <span class="k">if</span> <span class="n">lag</span><span class="p">:</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">-</span> <span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_tukey"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_tukey">[docs]</a><span class="k">def</span> <span class="nf">window_tukey</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs a Tukey window on a signal using a parameter alpha</span>

<span class="sd">    An alpha of 0 is a rectangular window</span>
<span class="sd">    An alpha of 1 is a Hann window</span>
<span class="sd">    Alpha should be between 0 and 1</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        alpha: type of window</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with Tukey window feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window tukey&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Tukey window&#39;</span>
                    <span class="p">)</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>
                    <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
                <span class="k">elif</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">):</span>
                    <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="n">alpha</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_cosine"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_cosine">[docs]</a><span class="k">def</span> <span class="nf">window_cosine</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs a Cosine (Sine) window on a signal</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with Cosine window feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window cosine&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Cosine window&#39;</span>
                    <span class="p">)</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_lanczos"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_lanczos">[docs]</a><span class="k">def</span> <span class="nf">window_lanczos</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs a Lanczos window on a signal</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with Lanczos window feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window lanczos&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Lanczos window&#39;</span>
                    <span class="p">)</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_triangular"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_triangular">[docs]</a><span class="k">def</span> <span class="nf">window_triangular</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs the triangular window on a signal</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with triangular window feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window triangular&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Triangular window&#39;</span>
                    <span class="p">)</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">nVec</span> <span class="o">-</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_bartlett"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_bartlett">[docs]</a><span class="k">def</span> <span class="nf">window_bartlett</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perfoms the Bartlet window on a signal</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with Bartlet window feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window bartlett&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Bartlett window&#39;</span>
                    <span class="p">)</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">nVec</span> <span class="o">-</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_gaussian"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_gaussian">[docs]</a><span class="k">def</span> <span class="nf">window_gaussian</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs a Gaussian window on a signal given a sigma</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        sigma: sigma value used by gaussian</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with Gaussian window feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window gaussian&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Gaussian window&#39;</span>
                    <span class="p">)</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span> <span class="p">(</span><span class="n">nVec</span> <span class="o">-</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span> <span class="p">)</span><span class="o">/</span><span class="p">(</span> <span class="n">sigma</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span> <span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_bartlett_hann"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_bartlett_hann">[docs]</a><span class="k">def</span> <span class="nf">window_bartlett_hann</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs a Bartlett-Hann window on a signal</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with Bartlett-Hann feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window bartlett-hann&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Bartlett-Hann window&#39;</span>
                    <span class="p">)</span>
            <span class="n">a0</span> <span class="o">=</span> <span class="mf">0.62</span>
            <span class="n">a1</span> <span class="o">=</span> <span class="mf">0.48</span>
            <span class="n">a2</span> <span class="o">=</span> <span class="mf">0.38</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">-</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="p">)</span> <span class="o">-</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_blackman"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_blackman">[docs]</a><span class="k">def</span> <span class="nf">window_blackman</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.16</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs a Blackman window on a signal given a parameter alpha</span>

<span class="sd">    Conventional Blackman sets alpha at 0.16</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        alpha: equation parameter</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with Blackman window feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Not sure on alpha range for this one</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">alpha</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window blackman&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Blackman window&#39;</span>
                    <span class="p">)</span>
            <span class="n">a0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span>
            <span class="n">a1</span> <span class="o">=</span> <span class="mf">0.5</span>
            <span class="n">a2</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">/</span><span class="mf">2.0</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">-</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="p">)</span><span class="o">/</span><span class="p">(</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="p">)</span><span class="o">/</span><span class="p">(</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_kaiser"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_kaiser">[docs]</a><span class="k">def</span> <span class="nf">window_kaiser</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">lag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs a Kaiser window on a signal with or without lag,</span>
<span class="sd">    given a parameter alpha. Alpha is usually 3</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        alpha: equation parameter</span>
<span class="sd">        lag: whether to include lag</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with Kaiser window feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Not sure on alpha range on this one</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window kaiser&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Kaiser window&#39;</span>
                    <span class="p">)</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">lag</span><span class="p">:</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">i0</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">i0</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">i0</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">alpha</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">i0</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">alpha</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_planck_taper"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_planck_taper">[docs]</a><span class="k">def</span> <span class="nf">window_planck_taper</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs a Planck-taper window on a signal, given a parameter epsilon</span>
<span class="sd">    Epsilon is 0.1 on wikipedia</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        epsilon: equation parameter</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with Planck-taper window feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Not sure if this needs to be bounded either</span>
    <span class="k">if</span> <span class="n">epsilon</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">epsilon</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window planck taper&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Planck-taper window&#39;</span>
                    <span class="p">)</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">Zplus</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">epsilon</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mf">2.0</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">epsilon</span><span class="o">+</span><span class="mf">2.0</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)))</span>
            <span class="n">Zminus</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">epsilon</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span> <span class="o">+</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">epsilon</span><span class="o">-</span><span class="mf">2.0</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)))</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                    <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Zplus</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">epsilon</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">):</span>
                    <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="k">elif</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">):</span>
                    <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Zminus</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_nuttall"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_nuttall">[docs]</a><span class="k">def</span> <span class="nf">window_nuttall</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform a Nuttall window on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with Nuttall window feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window nuttall&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Nuttall Window&#39;</span>
                    <span class="p">)</span>
            <span class="n">a0</span> <span class="o">=</span> <span class="mf">0.355768</span>
            <span class="n">a1</span> <span class="o">=</span> <span class="mf">0.487396</span>
            <span class="n">a2</span> <span class="o">=</span> <span class="mf">0.144232</span>
            <span class="n">a3</span> <span class="o">=</span> <span class="mf">0.012604</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">-</span> <span class="n">a1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span> <span class="o">-</span> <span class="n">a3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">6.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_blackman_harris"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_blackman_harris">[docs]</a><span class="k">def</span> <span class="nf">window_blackman_harris</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform a Blackman-Harris window on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with Blackman-Harris window feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window blackman-harris&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Blackman-Harris window&#39;</span>
                    <span class="p">)</span>
            <span class="n">a0</span> <span class="o">=</span> <span class="mf">0.35875</span>
            <span class="n">a1</span> <span class="o">=</span> <span class="mf">0.48829</span>
            <span class="n">a2</span> <span class="o">=</span> <span class="mf">0.14128</span>
            <span class="n">a3</span> <span class="o">=</span> <span class="mf">0.01168</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">-</span> <span class="n">a1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span> <span class="o">-</span> <span class="n">a3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">6.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_blackman_nuttall"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_blackman_nuttall">[docs]</a><span class="k">def</span> <span class="nf">window_blackman_nuttall</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform a Blackman-Nuttall window on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with Blackman-Nuttall window feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window blackman-nuttall&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Blackman-Nuttall Window&#39;</span>
                    <span class="p">)</span>
            <span class="n">a0</span> <span class="o">=</span> <span class="mf">0.3635819</span>
            <span class="n">a1</span> <span class="o">=</span> <span class="mf">0.4891775</span>
            <span class="n">a2</span> <span class="o">=</span> <span class="mf">0.1365995</span>
            <span class="n">a3</span> <span class="o">=</span> <span class="mf">0.0106411</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">-</span> <span class="n">a1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span> <span class="o">-</span> <span class="n">a3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">6.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="window_flat_top"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.window_flat_top">[docs]</a><span class="k">def</span> <span class="nf">window_flat_top</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform a flat top window on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with flat top window feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;window flat top&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Window Flat Top&#39;</span>
                    <span class="p">)</span>
            <span class="n">a0</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">a1</span> <span class="o">=</span> <span class="mf">1.93</span>
            <span class="n">a2</span> <span class="o">=</span> <span class="mf">1.29</span>
            <span class="n">a3</span> <span class="o">=</span> <span class="mf">0.388</span>
            <span class="n">a4</span> <span class="o">=</span> <span class="mf">0.028</span>
            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">nVec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">-</span> <span class="n">a1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span> <span class="o">+</span> <span class="n">a2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span> <span class="o">-</span> <span class="n">a3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">6.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span> <span class="o">+</span> <span class="n">a4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">8.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">nVec</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">w</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="sub_sample_data"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.sub_sample_data">[docs]</a><span class="k">def</span> <span class="nf">sub_sample_data</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sub-sample the data</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        window_size: size of the window</span>
<span class="sd">        step_size: size of the steps</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Sub sample data pair</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sub sample&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="c1"># Just a couple of checks on the inputs</span>
    <span class="n">window_size</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">window_size</span><span class="p">)</span>
    <span class="n">step_size</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">step_size</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">window_size</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">window_size</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">step_size</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">step_size</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">new_instances</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Features to Features available for sub sampling&#39;</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">data_labels</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for sub sampling&#39;</span>
                    <span class="p">)</span>

            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">window_size</span> <span class="o">&gt;</span> <span class="n">N</span><span class="p">:</span>
                <span class="n">window_size</span> <span class="o">=</span> <span class="n">N</span>
            <span class="k">if</span> <span class="n">step_size</span> <span class="o">&gt;</span> <span class="n">N</span><span class="p">:</span>
                <span class="n">step_size</span> <span class="o">=</span> <span class="n">N</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span> <span class="o">-</span> <span class="n">window_size</span><span class="p">:</span>
                <span class="n">new_stream_data</span> <span class="o">=</span> <span class="n">StreamData</span><span class="p">()</span>
                <span class="n">new_stream_data</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">window_size</span><span class="p">],</span>
                                  <span class="n">labels</span><span class="o">=</span><span class="n">data_labels</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">window_size</span><span class="p">])</span>
                <span class="c1">#new_stream_data.set_target(instance.get_stream().get_target())</span>

                <span class="n">new_feature_data</span> <span class="o">=</span> <span class="n">FeatureData</span><span class="p">()</span>
                <span class="c1">#new_feature_data.set_target(instance.get_features().get_target())</span>

                <span class="n">new_instance</span> <span class="o">=</span> <span class="n">GTMOEPDataInstance</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">new_feature_data</span><span class="p">,</span>
                                        <span class="n">stream</span><span class="o">=</span><span class="n">new_stream_data</span><span class="p">,</span>
                                        <span class="n">target</span><span class="o">=</span><span class="n">instance</span><span class="o">.</span><span class="n">get_target</span><span class="p">())</span>
                <span class="n">new_instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_instance</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="n">step_size</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">new_instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="cut_data_lead"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.cut_data_lead">[docs]</a><span class="k">def</span> <span class="nf">cut_data_lead</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">samples_to_cut</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cut samples_to_cut from the front of the data</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        samples_to_cut: number of samples to cut</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Cut data pair</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert to an int to prevent deprication warnings</span>
    <span class="n">samples_to_cut</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">samples_to_cut</span><span class="p">)</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cut data lead&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">data_labels</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">data_labels</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Cut Data Lead&#39;</span>
                    <span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">samples_to_cut</span><span class="p">:]</span>
            <span class="n">data_labels</span> <span class="o">=</span> <span class="n">data_labels</span><span class="p">[</span><span class="n">samples_to_cut</span><span class="p">:]</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_labels</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="my_dwt"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_dwt">[docs]</a><span class="k">def</span> <span class="nf">my_dwt</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform a dwt on a dataset</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dwt&#39;</span><span class="p">);</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span> <span class="ow">or</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">coeff_list</span> <span class="o">=</span> <span class="n">pywt</span><span class="o">.</span><span class="n">wavedec</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;db3&#39;</span><span class="p">)</span>
            <span class="n">vec</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="p">[</span><span class="n">vec</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">level</span><span class="p">)</span> <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">coeff_list</span><span class="p">]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">old_features</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">new_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">old_features</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
                <span class="c1">#data_labels = np.arange(0, 2*np.pi, 2*np.pi/len(data))</span>
                <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

                <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_labels</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>
                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                                         <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">(),</span>
                                         <span class="n">data_labels</span>
                                        <span class="p">))</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span>
                                                <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_features</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                                                <span class="n">labels</span><span class="o">=</span><span class="n">new_labels</span>
                                                <span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="my_rms_2d"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_rms_2d">[docs]</a><span class="k">def</span> <span class="nf">my_rms_2d</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">STREAM_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes rms of 2D data</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        axis: id of which axis to use</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with rms feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">axis_options</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">axis</span> <span class="o">=</span> <span class="n">axis_options</span><span class="p">[</span><span class="n">axis</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">axis_options</span><span class="p">)]</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rms_2d&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
            	<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Features to Features available for 2D RMS&#39;</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span> <span class="ow">or</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)])</span>
           <span class="c1"># if mode is FEATURES_TO_FEATURES:</span>
           <span class="c1">#     data_labels = np.array([str(p)+&#39;-Norm&#39; + str(len(data.flatten()))])</span>
           <span class="c1">#     instance.get_features().set_data(data, labels=data_labels)</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;rms2d-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">old_features</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">new_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">old_features</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
                <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;rms2d-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_features</span><span class="p">))])</span>
                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                                         <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">(),</span>
                                         <span class="n">data_labels</span>
                                        <span class="p">))</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span>
                                                <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_features</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                                                <span class="n">labels</span><span class="o">=</span><span class="n">new_labels</span>
                                                <span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="my_norm"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_norm">[docs]</a><span class="k">def</span> <span class="nf">my_norm</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">STREAM_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the p norm on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        p: value of p</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with p norm feature added</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;norm&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span> <span class="ow">or</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">p</span><span class="p">)]])</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-Norm&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))])</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-Norm&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))])</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">old_features</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">new_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">old_features</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
                <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-Norm&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_features</span><span class="p">))])</span>
                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                                         <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">(),</span>
                                         <span class="n">data_labels</span>
                                        <span class="p">))</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span>
                                                <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_features</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                                                <span class="n">labels</span><span class="o">=</span><span class="n">new_labels</span>
                                                <span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="my_sum"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_sum">[docs]</a><span class="k">def</span> <span class="nf">my_sum</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sum a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with sum feature added</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span> <span class="ow">or</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">data</span><span class="p">)]])</span>
            <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;Sum&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">old_features</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">new_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">old_features</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                                         <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">(),</span>
                                         <span class="n">data_labels</span>
                                        <span class="p">))</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span>
                                                <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_features</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                                                <span class="n">labels</span><span class="o">=</span><span class="n">new_labels</span>
                                                <span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_prod"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_prod">[docs]</a><span class="k">def</span> <span class="nf">my_prod</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform an fft on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with prod feature added</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;prod&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span> <span class="ow">or</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">data</span><span class="p">)]])</span>
            <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;Prod&#39;</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">old_features</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">new_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">old_features</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                                         <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">(),</span>
                                         <span class="n">data_labels</span>
                                        <span class="p">))</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span>
                                                <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_features</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                                                <span class="n">labels</span><span class="o">=</span><span class="n">new_labels</span>
                                                <span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_cum_prod"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_cum_prod">[docs]</a><span class="k">def</span> <span class="nf">my_cum_prod</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the cumulative product on each point in a dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with cumulative product feature added</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cummulative product&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span> <span class="ow">or</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumprod</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">old_features</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">new_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">old_features</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;CumProd&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))])</span>

                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                                         <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">(),</span>
                                         <span class="n">labels</span>
                                        <span class="p">))</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span>
                                                 <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_features</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                                                 <span class="n">labels</span><span class="o">=</span><span class="n">new_labels</span>
                                                <span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_cum_sum"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_cum_sum">[docs]</a><span class="k">def</span> <span class="nf">my_cum_sum</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the cumulative sum on each point in a dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with cumulative sum feature added</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cummulative sum&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span> <span class="ow">or</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">old_features</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">new_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">old_features</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;CumSum&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))])</span>
                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                                         <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">(),</span>
                                         <span class="n">labels</span>
                                        <span class="p">))</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span>
                                                 <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_features</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                                                 <span class="n">labels</span><span class="o">=</span><span class="n">new_labels</span>
                                                <span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_fft"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_fft">[docs]</a><span class="k">def</span> <span class="nf">my_fft</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform an fft on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with fft feature added</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fft&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span> <span class="ow">or</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">old_features</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="c1">#print data.flatten().shape, old_features.flatten().shape</span>
                <span class="n">new_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">old_features</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
                <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">data_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_labels</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>
                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                                         <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">(),</span>
                                         <span class="n">data_labels</span>
                                        <span class="p">))</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span>
                                                 <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_features</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                                                 <span class="n">labels</span><span class="o">=</span><span class="n">new_labels</span>
                                                <span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_abs"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_abs">[docs]</a><span class="k">def</span> <span class="nf">my_abs</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform an absolute value on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with absolute value feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;abs&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for abs&#39;</span>
                    <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_exp"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_exp">[docs]</a><span class="k">def</span> <span class="nf">my_exp</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform an exponential on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with exponential feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;exp&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Exponential&#39;</span>
                    <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_tangent"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_tangent">[docs]</a><span class="k">def</span> <span class="nf">my_tangent</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform a tangent on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with tangent feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;tangent&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Tangent&#39;</span>
                    <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="my_cosine"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_cosine">[docs]</a><span class="k">def</span> <span class="nf">my_cosine</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform a cosine on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with cosine feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cosine&#39;</span><span class="p">);</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Cosine&#39;</span>
                    <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_sine"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_sine">[docs]</a><span class="k">def</span> <span class="nf">my_sine</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform a sine on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with sine feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;sine&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Sine&#39;</span>
                    <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_arctangent"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_arctangent">[docs]</a><span class="k">def</span> <span class="nf">my_arctangent</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform an arctangent on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with arctangent feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arctangent&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Arctangent&#39;</span>
                    <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="my_arccosine"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_arccosine">[docs]</a><span class="k">def</span> <span class="nf">my_arccosine</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform an arccosine on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with arccosine feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arccosine&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Arccosine&#39;</span>
                    <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_arcsine"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_arcsine">[docs]</a><span class="k">def</span> <span class="nf">my_arcsine</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform an arcsine on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with arcsine feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arcsine&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for arcsine&#39;</span>
                    <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="my_log"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_log">[docs]</a><span class="k">def</span> <span class="nf">my_log</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform a natural log on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with natural log feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">);</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Log&#39;</span>
                    <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_round"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_round">[docs]</a><span class="k">def</span> <span class="nf">my_round</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform a round on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with round feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;round&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Round&#39;</span>
                    <span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_kalman_filter"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_kalman_filter">[docs]</a><span class="k">def</span> <span class="nf">my_kalman_filter</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mf">0.1</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform a kalman filter on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        Q: equation paramater</span>
<span class="sd">        R: equation parameter</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with kalman filter feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;kalman filter&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Kalman Filter&#39;</span>
                    <span class="p">)</span>

            <span class="n">N</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">xhat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>          <span class="c1"># A posteri estimate of x</span>
                <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>             <span class="c1"># A posteri error estimate</span>
                <span class="n">xhatminus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>     <span class="c1"># A priori estimate of x</span>
                <span class="n">Pminus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>        <span class="c1"># A priori error estimate</span>
                <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>             <span class="c1"># gain or blending factor</span>
                <span class="c1"># Q = 1e-5                  # process variance       # What should this be?</span>
                <span class="n">xhat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>                  <span class="c1"># What should this be?</span>
                <span class="c1"># R = 0.1**2                # What should this be?</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
                    <span class="n">xhatminus</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">xhat</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">Pminus</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">Q</span>

                    <span class="n">K</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pminus</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">Pminus</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">R</span><span class="p">)</span>
                    <span class="n">xhat</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">xhatminus</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">K</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">xhatminus</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">P</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">K</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">*</span><span class="n">Pminus</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

                <span class="n">new_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xhat</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="my_linear_predictive_coding"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_linear_predictive_coding">[docs]</a><span class="k">def</span> <span class="nf">my_linear_predictive_coding</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">STREAM_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the LPC coefficients</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        p: equation parameter</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with LPC coefficients feature added</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LPC&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span> <span class="ow">or</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">F</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">row</span><span class="p">]))</span>
                <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="o">*</span><span class="n">F</span>
                <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
                <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
                <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">)))</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
                        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">)]</span>
                <span class="n">colR</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)))</span>
                <span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">*</span><span class="n">colR</span>
                <span class="n">coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
                <span class="n">rows</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rows</span><span class="p">])</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;LPC&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">old_features</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">new_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">old_features</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                                         <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">(),</span>
                                         <span class="n">labels</span>
                                        <span class="p">))</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span>
                                                 <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_features</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                                                 <span class="n">labels</span><span class="o">=</span><span class="n">new_labels</span>
                                                <span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="my_wiener_filter"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_wiener_filter">[docs]</a><span class="k">def</span> <span class="nf">my_wiener_filter</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Perform a wiener on a dataset</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with wiener feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;wiener&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Wiener Filter&#39;</span>
                    <span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">wiener</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_savitzky_golay_filter"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_savitzky_golay_filter">[docs]</a><span class="k">def</span> <span class="nf">my_savitzky_golay_filter</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">FEATURES_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes the Savitzky-Golay filter on the data</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        N: inner method paramater</span>
<span class="sd">        M: inner method parameter</span>
<span class="sd">        deriv: inner method parameter</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with wiener feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">deriv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">deriv</span><span class="p">)</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;savgol&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Savitzky-Golay&#39;</span>
                    <span class="p">)</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">savitzky_golay</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">deriv</span><span class="p">))</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_pca"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_pca">[docs]</a><span class="k">def</span> <span class="nf">my_pca</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">whiten</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implements scikit&#39;s pca method</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        n_components: number of components to keep</span>
<span class="sd">        whiten: When True (False by default) the components_ vectors are</span>
<span class="sd">        multiplied by the square root of n_samples and then divided by the</span>
<span class="sd">        singular values to ensure uncorrelated outputs with unit</span>
<span class="sd">        component-wise variances.</span>

<span class="sd">        Whitening will remove some information from the transformed signal</span>
<span class="sd">        (the relative variance scales of the components) but can sometime</span>
<span class="sd">        improve the predictive accuracy of the downstream estimators by making</span>
<span class="sd">        their data respect some hard-wired assumptions. --sklearn</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair transformed with pca</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert n_components to int in case a boolean is received</span>
    <span class="n">n_components</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_components</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="c1">#target_values = np.array([inst.get_features().get_target()[0] for</span>
    <span class="c1">#                   inst in data_pair.get_train_data().get_instances()])</span>
    <span class="n">my_pca_transform</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">decomposition</span><span class="o">.</span><span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">,</span>
                        <span class="n">whiten</span><span class="o">=</span><span class="n">whiten</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>

    <span class="n">new_training_data</span> <span class="o">=</span> <span class="n">my_pca_transform</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pca&#39;</span><span class="p">),</span> <span class="n">new_training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">new_testing_data</span> <span class="o">=</span> <span class="n">my_pca_transform</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;PCA&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">new_testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="k">for</span> <span class="n">old_instance</span><span class="p">,</span> <span class="n">new_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span>
        <span class="n">new_training_data</span><span class="p">):</span>

        <span class="n">old_instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_instance</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">old_instance</span><span class="p">,</span> <span class="n">new_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span>
        <span class="n">new_testing_data</span><span class="p">):</span>

        <span class="n">old_instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_instance</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_sparse_pca"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_sparse_pca">[docs]</a><span class="k">def</span> <span class="nf">my_sparse_pca</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implements scikit&#39;s sparse pca method</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.SparsePCA.html#sklearn.decomposition.SparsePCA</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        n_components: number of components to keep</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair transformed with sparse pca</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert n_components to int in case a boolean is received</span>
    <span class="n">n_components</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_components</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="c1">#target_values = np.array([inst.get_features().get_target()[0] for</span>
    <span class="c1">#                   inst in data_pair.get_train_data().get_instances()])</span>
    <span class="n">my_spca_transform</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">decomposition</span><span class="o">.</span><span class="n">SparsePCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">,</span>
                        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>

    <span class="n">new_training_data</span> <span class="o">=</span> <span class="n">my_spca_transform</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;spca&#39;</span><span class="p">),</span> <span class="n">new_training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">new_testing_data</span> <span class="o">=</span> <span class="n">my_spca_transform</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;SparsePCA&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">new_testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="k">for</span> <span class="n">old_instance</span><span class="p">,</span> <span class="n">new_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span>
        <span class="n">new_training_data</span><span class="p">):</span>

        <span class="n">old_instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_instance</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">old_instance</span><span class="p">,</span> <span class="n">new_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span>
        <span class="n">new_testing_data</span><span class="p">):</span>

        <span class="n">old_instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_instance</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_ica"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_ica">[docs]</a><span class="k">def</span> <span class="nf">my_ica</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">whiten</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implements scikit&#39;s ica method</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.decomposition.FastICA.html</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        n_components: number of components to keep</span>
<span class="sd">        whiten: When True (True by default) the components_ vectors are</span>
<span class="sd">        multiplied by the square root of n_samples and then divided by the</span>
<span class="sd">        singular values to ensure uncorrelated outputs with unit</span>
<span class="sd">        component-wise variances.</span>

<span class="sd">        Whitening will remove some information from the transformed signal</span>
<span class="sd">        (the relative variance scales of the components) but can sometime</span>
<span class="sd">        improve the predictive accuracy of the downstream estimators by making</span>
<span class="sd">        their data respect some hard-wired assumptions. --sklearn</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair transformed with ica</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert n_components to int in case a boolean is received</span>
    <span class="n">n_components</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_components</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="c1">#target_values = np.array([inst.get_features().get_target()[0] for</span>
    <span class="c1">#                   inst in data_pair.get_train_data().get_instances()])</span>
    <span class="n">my_ica_transform</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">decomposition</span><span class="o">.</span><span class="n">FastICA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">,</span>
                        <span class="n">whiten</span><span class="o">=</span><span class="n">whiten</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>

    <span class="n">new_training_data</span> <span class="o">=</span> <span class="n">my_ica_transform</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ica&#39;</span><span class="p">),</span> <span class="n">new_training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">new_testing_data</span> <span class="o">=</span> <span class="n">my_ica_transform</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;ICA&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">new_testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="k">for</span> <span class="n">old_instance</span><span class="p">,</span> <span class="n">new_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span>
        <span class="n">new_training_data</span><span class="p">):</span>

        <span class="n">old_instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_instance</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">old_instance</span><span class="p">,</span> <span class="n">new_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span>
        <span class="n">new_testing_data</span><span class="p">):</span>

        <span class="n">old_instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_instance</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_spectral_embedding"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_spectral_embedding">[docs]</a><span class="k">def</span> <span class="nf">my_spectral_embedding</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implements scikit&#39;s spectral embedding method</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.manifold.SpectralEmbedding.html</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        n_components: the dimension of the projected subspace</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair transformed with spectral embedding</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert n_components to int in case a boolean is received</span>
    <span class="n">n_components</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_components</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="c1">#target_values = np.array([inst.get_features().get_target()[0] for</span>
    <span class="c1">#                   inst in data_pair.get_train_data().get_instances()])</span>
    <span class="n">my_spectral_transform</span> <span class="o">=</span> <span class="n">SpectralEmbedding</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>

    <span class="n">new_training_data</span> <span class="o">=</span> <span class="n">my_spectral_transform</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;spectral embedding&#39;</span><span class="p">),</span> <span class="n">new_training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">new_testing_data</span> <span class="o">=</span> <span class="n">my_spectral_transform</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;Spectral&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">new_testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
    <span class="k">for</span> <span class="n">old_instance</span><span class="p">,</span> <span class="n">new_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span>
        <span class="n">new_training_data</span><span class="p">):</span>

        <span class="n">old_instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_instance</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">old_instance</span><span class="p">,</span> <span class="n">new_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span>
        <span class="n">new_testing_data</span><span class="p">):</span>

        <span class="n">old_instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_instance</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>

    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_ecdf"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_ecdf">[docs]</a><span class="k">def</span> <span class="nf">my_ecdf</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">STREAM_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implements ECDF method</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        n_components: the dimension of projected space</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair transformed with ECDF</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert n_components to int in case a boolean is received</span>
    <span class="n">n_components</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_components</span><span class="p">)</span>

    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ecdf&#39;</span><span class="p">);</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">ecdfRep</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n_components</span><span class="p">)</span>

            <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;LPC&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">old_features</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">new_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">old_features</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                                         <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">(),</span>
                                         <span class="n">labels</span>
                                        <span class="p">))</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span>
                                                 <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_features</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                                                 <span class="n">labels</span><span class="o">=</span><span class="n">new_labels</span>
                                                <span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_rebase"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_rebase">[docs]</a><span class="k">def</span> <span class="nf">my_rebase</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">STREAM_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Subtracts min from signal</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with rebase feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;rebase&#39;</span><span class="p">);</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="c1">#data = cp.deepcopy(instance.get_features().get_data())</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="c1">#labels = cp.deepcopy(instance.get_features().get_labels())</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="c1">#data = cp.deepcopy(instance.get_stream().get_data())</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="c1">#labels = cp.deepcopy(instance.get_stream().get_labels())</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">&#39;No Stream to Features available for Rebase&#39;</span>
                    <span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>


        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_peak_finder"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_peak_finder">[docs]</a><span class="k">def</span> <span class="nf">my_peak_finder</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">start_delta</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">lookForMax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">STREAM_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Zero out all but the peaks in the data</span>

<span class="sd">    delta is the amount to withdraw before locking</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        start_delta: initial value of delta</span>
<span class="sd">        lookForMax: max parameter</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with peak finder feature added</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;peak finder&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="c1">#data = cp.deepcopy(instance.get_features().get_data())</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span> <span class="ow">or</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="c1">#data = cp.deepcopy(instance.get_stream().get_data())</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
                <span class="n">min_pos</span><span class="p">,</span> <span class="n">max_pos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
                <span class="n">min_locs</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">max_locs</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">delta</span> <span class="o">=</span> <span class="n">start_delta</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)):</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="n">max_val</span><span class="p">:</span>
                        <span class="n">max_val</span> <span class="o">=</span> <span class="n">val</span>
                        <span class="n">max_pos</span> <span class="o">=</span> <span class="n">i</span>
                    <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">min_val</span><span class="p">:</span>
                        <span class="n">min_val</span> <span class="o">=</span> <span class="n">val</span>
                        <span class="n">min_pos</span> <span class="o">=</span> <span class="n">i</span>

                    <span class="k">if</span> <span class="n">lookForMax</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">max_val</span> <span class="o">-</span> <span class="n">delta</span><span class="p">):</span>
                            <span class="n">max_locs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">max_pos</span><span class="p">]</span>
                            <span class="n">min_val</span> <span class="o">=</span> <span class="n">val</span>
                            <span class="n">min_pos</span> <span class="o">=</span> <span class="n">i</span>
                            <span class="n">lookForMax</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">min_val</span> <span class="o">+</span> <span class="n">delta</span><span class="p">):</span>
                            <span class="n">min_locs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">min_pos</span><span class="p">]</span>
                            <span class="n">max_val</span> <span class="o">=</span> <span class="n">val</span>
                            <span class="n">max_pos</span> <span class="o">=</span> <span class="n">i</span>
                            <span class="n">lookForMax</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="c1">#delta = delta*0.9999</span>
                <span class="c1">#print minLocs, maxLocs</span>
                <span class="c1">#peak_locs = min_locs + max_locs # concat two lists</span>
                <span class="c1">#print delta</span>
                <span class="n">peak_locs</span> <span class="o">=</span> <span class="n">max_locs</span> <span class="c1"># concat two lists</span>
                <span class="n">not_peaks</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">))</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">peak_locs</span><span class="p">]</span>
                <span class="c1">#print row</span>
                <span class="n">row</span><span class="p">[</span><span class="n">not_peaks</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">old_features</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">new_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">old_features</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;Peaks&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))])</span>
                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                                         <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">(),</span>
                                         <span class="n">labels</span>
                                        <span class="p">))</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span>
                                                 <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_features</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                                                 <span class="n">labels</span><span class="o">=</span><span class="n">new_labels</span>
                                                <span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="my_informed_search"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.my_informed_search">[docs]</a><span class="k">def</span> <span class="nf">my_informed_search</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">peak_data_pair</span><span class="p">,</span> <span class="n">search_window</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">log_slope_thresh</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">STREAM_TO_FEATURES</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Zero out all but the peaks in the data</span>

<span class="sd">    delta is the amount to withdraw before locking</span>

<span class="sd">    Args:</span>
<span class="sd">        datapair: given datapair</span>
<span class="sd">        peak_data_pair: given peak datapair</span>
<span class="sd">        search_window: size of search window</span>
<span class="sd">        log_slope_thresh: equation parameter</span>
<span class="sd">        mode: iteration mode, options: FEATURES_TO_FEATURES,</span>
<span class="sd">        STREAM_TO_STREAM, or STREAM_TO_FEATURES</span>

<span class="sd">    Returns:</span>
<span class="sd">        Data pair with informed search feature added</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For debugging purposes let&#39;s print out method name</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;informed search&#39;</span><span class="p">)</span> <span class="p">;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">data_set</span><span class="p">,</span> <span class="n">peak_data_set</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()],</span>
        <span class="p">[</span><span class="n">peak_data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">peak_data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]</span>
        <span class="p">):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>
        <span class="n">peak_instances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">peak_data_set</span><span class="o">.</span><span class="n">get_instances</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">instance</span><span class="p">,</span> <span class="n">peak_instance</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">peak_instances</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="c1">#data = cp.deepcopy(instance.get_features().get_data())</span>
                <span class="c1">#peak_data = cp.deepcopy(peak_instance.get_features().get_data())</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">peak_data</span> <span class="o">=</span> <span class="n">peak_instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span> <span class="ow">or</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="c1">#data = cp.deepcopy(instance.get_stream().get_data())</span>
                <span class="c1">#peak_data = cp.deepcopy(peak_instance.get_stream().get_data())</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">peak_data</span> <span class="o">=</span> <span class="n">peak_instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">peak_data</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Peaks and data do not match in shape&#39;</span><span class="p">)</span>
            <span class="n">deriv</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="n">order</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="n">window_length</span> <span class="o">=</span> <span class="mi">11</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">maxzcs</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">peak_row</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">peak_data</span><span class="p">):</span>
                <span class="c1">#print row</span>
                <span class="n">zero_crossings</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">log_slopes</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">all_smoothed_data</span> <span class="o">=</span> <span class="n">savitzky_golay</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">window_length</span><span class="p">,</span>
                    <span class="n">order</span><span class="p">,</span> <span class="n">deriv</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">search_window</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">peak_row</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">peak_row</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">search_window</span>
                        <span class="c1"># Take the Second derivative</span>
                        <span class="n">smoothed_data</span> <span class="o">=</span> <span class="n">all_smoothed_data</span><span class="p">[</span><span class="n">k</span><span class="p">:</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">zero_crossing</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="c1"># Find the Zero crossing if any</span>
                        <span class="n">interest_point_zero_crossings</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">interest_point_log_slopes</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">search_window</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                            <span class="k">if</span> <span class="n">smoothed_data</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">smoothed_data</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="n">log_slope</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">3</span><span class="p">]))</span>
                                <span class="n">zero_crossing</span> <span class="o">=</span> <span class="n">k</span><span class="o">+</span><span class="n">j</span>

                                <span class="c1"># log the point</span>
                                <span class="n">interest_point_zero_crossings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zero_crossing</span><span class="p">)</span>
                                <span class="n">interest_point_log_slopes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">log_slope</span><span class="p">)</span>
                        <span class="n">interest_point_log_slopes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">interest_point_log_slopes</span><span class="p">)</span>
                        <span class="n">interest_point_zero_crossings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">interest_point_zero_crossings</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">interest_point_log_slopes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">log_slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">interest_point_log_slopes</span><span class="p">)</span>
                            <span class="c1">#print &#39;SLOPE&#39;, log_slope</span>
                            <span class="k">if</span> <span class="n">log_slope</span> <span class="o">&gt;=</span> <span class="n">log_slope_thresh</span><span class="p">:</span>
                                <span class="n">log_slope_loc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">interest_point_log_slopes</span><span class="p">)</span>
                                <span class="n">zero_crossings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">interest_point_zero_crossings</span><span class="p">[</span><span class="n">log_slope_loc</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">maxzcs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># This will protect against empty data</span>
                    <span class="n">maxzcs</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="c1"># Keep track of most zero crossings for pading</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zero_crossings</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">maxzcs</span><span class="p">:</span>
                    <span class="n">maxzcs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">zero_crossings</span><span class="p">)</span>
                <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zero_crossings</span><span class="p">)</span>
            <span class="c1"># Pad the rows</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)):</span>
                <span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">maxzcs</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">FEATURES_TO_FEATURES</span><span class="p">:</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;InterestPts&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))])</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_STREAM</span><span class="p">:</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;InterestPts&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_stream</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">mode</span> <span class="ow">is</span> <span class="n">STREAM_TO_FEATURES</span><span class="p">:</span>
                <span class="n">old_features</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">new_features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">old_features</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;InterestPts&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))])</span>
                <span class="n">new_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
                                         <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">get_labels</span><span class="p">(),</span>
                                         <span class="n">labels</span>
                                        <span class="p">))</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">get_features</span><span class="p">()</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span>
                                                 <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">new_features</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span>
                                                 <span class="n">labels</span><span class="o">=</span><span class="n">new_labels</span>
                                                <span class="p">)</span>

        <span class="n">new_data_set</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span>
        <span class="n">data_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data_set</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">train_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                   <span class="n">test_data</span><span class="o">=</span><span class="n">data_list</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">();</span> <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="savitzky_golay"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.savitzky_golay">[docs]</a><span class="k">def</span> <span class="nf">savitzky_golay</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">window_size</span><span class="p">,</span> <span class="n">order</span><span class="p">,</span> <span class="n">deriv</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Smooth (and optionally differentiate) data with a Savitzky-Golay filter.</span>

<span class="sd">    The Savitzky-Golay filter removes high frequency noise from data.</span>
<span class="sd">	It has the advantage of preserving the original shape and</span>
<span class="sd">	features of the signal better than other types of filtering</span>
<span class="sd">	approaches, such as moving averages techhniques.</span>

<span class="sd">    Args:</span>
<span class="sd">        y: the values of the time history of the signal</span>
<span class="sd">        window_size: the length of the window. Must be an odd integer number</span>
<span class="sd">        order: the order of the polynomial used in the filtering.</span>
<span class="sd">		Must be less then `window_size` - 1</span>
<span class="sd">        deriv: the order of the derivative to compute</span>
<span class="sd">        (default = 0 means only smoothing)</span>

<span class="sd">    Returns:</span>
<span class="sd">        the smoothed signal (or it&#39;s n-th derivative)</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError, TypeError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">window_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">window_size</span><span class="p">))</span>
        <span class="n">order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">order</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;window_size and order have to be of type int&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">window_size</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">window_size</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;window_size size must be a positive odd number&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">window_size</span> <span class="o">&lt;</span> <span class="n">order</span> <span class="o">+</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;window_size is too small for the polynomials order&quot;</span><span class="p">)</span>
    <span class="n">order_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">order</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">half_window</span> <span class="o">=</span> <span class="p">(</span><span class="n">window_size</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="c1"># precompute coefficients</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">([[</span><span class="n">k</span><span class="o">**</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">order_range</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">half_window</span><span class="p">,</span> <span class="n">half_window</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">A</span><span class="p">[</span><span class="n">deriv</span><span class="p">]</span>
    <span class="c1"># pad the signal at the extremes with</span>
    <span class="c1"># values taken from the signal itself</span>
    <span class="n">firstvals</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">half_window</span><span class="o">+</span><span class="mi">1</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
    <span class="n">lastvals</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="n">half_window</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">firstvals</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">lastvals</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span> <span class="n">m</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="ecdfRep"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.ecdfRep">[docs]</a><span class="k">def</span> <span class="nf">ecdfRep</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">components</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Estimate ecdf-representation according to Hammerla, Nils Y., et al.</span>
<span class="sd">    &quot;On preserving statistical characteristics of accelerometry data using</span>
<span class="sd">    their empirical cumulative distribution.&quot; ISWC. ACM, 2013.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: input data (rows = samples)</span>
<span class="sd">        components: number of components to extract per axis</span>

<span class="sd">    Returns:</span>
<span class="sd">        data representation with M = d*components+d elements</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">num</span><span class="o">=</span><span class="n">components</span><span class="p">)))]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span></div>

<div class="viewcode-block" id="myArgMin"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.myArgMin">[docs]</a><span class="k">def</span> <span class="nf">myArgMin</span><span class="p">(</span><span class="n">dataPair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Calculates Argmin of data pair</span>

<span class="sd">    Args:</span>
<span class="sd">        dataPair: given data pair</span>

<span class="sd">    Returns:</span>
<span class="sd">        modified data pair</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dataPair</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">dataPair</span><span class="p">)</span>
    <span class="n">mins</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">dataPair</span><span class="o">.</span><span class="n">testData</span><span class="o">.</span><span class="n">numpy</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">]:</span>
        <span class="n">mins</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">row</span><span class="p">)]</span>

    <span class="n">dataPair</span><span class="o">.</span><span class="n">testData</span><span class="o">.</span><span class="n">numpy</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mins</span>
    <span class="n">dataPair</span><span class="o">.</span><span class="n">testData</span><span class="o">.</span><span class="n">numpy</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="p">))]</span><span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">dataPair</span><span class="o">.</span><span class="n">testData</span><span class="o">.</span><span class="n">numpy</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">]])</span>
    <span class="n">dataPair</span><span class="o">.</span><span class="n">testData</span><span class="o">.</span><span class="n">rebuildFromNumpy</span><span class="p">()</span>
    <span class="c1"># TODO: We want to add on new class value as a feature as well</span>
    <span class="k">return</span> <span class="n">dataPair</span></div>

<span class="c1"># THE COULD BELOW WOULD REQUIRE A CHANGE IN THE STRUCTURE OF ALL METHODS ABOVE ######</span>
<span class="c1"># IT WOULD MAKE NEW METHODS EASIER TO IMPLEMENT AND REQUIRE LESS CODE ##########</span>

<div class="viewcode-block" id="testMethod"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.testMethod">[docs]</a><span class="k">def</span> <span class="nf">testMethod</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span></div>


<span class="n">methodList</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">methodList</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>

<div class="viewcode-block" id="commonTemplate"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.signal_methods.commonTemplate">[docs]</a><span class="k">def</span> <span class="nf">commonTemplate</span><span class="p">(</span><span class="n">dataPair</span><span class="p">,</span> <span class="n">functionName</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">dataList</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">dataSet</span> <span class="ow">in</span> <span class="p">[</span><span class="n">dataPair</span><span class="o">.</span><span class="n">trainData</span><span class="p">,</span> <span class="n">dataPair</span><span class="o">.</span><span class="n">testData</span><span class="p">]:</span>
        <span class="c1">#data = cp.deepcopy(dataSet.data)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">dataSet</span><span class="o">.</span><span class="n">data</span>
        <span class="n">newDataSet</span> <span class="o">=</span> <span class="n">GTMOEPData</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">point</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">point</span><span class="o">.</span><span class="n">features</span><span class="p">])</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Pull method from list of available methods</span>
            <span class="n">method</span> <span class="o">=</span> <span class="n">methodList</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">functionName</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">signal</span> <span class="ow">in</span> <span class="n">point</span><span class="o">.</span><span class="n">features</span><span class="p">:</span>
                <span class="c1"># Call signal method with args</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">method</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">args</span><span class="p">))</span>
            <span class="n">point</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="n">newDataSet</span><span class="o">.</span><span class="n">rebuildFromData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">dataList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newDataSet</span><span class="p">)</span>
    <span class="n">newDataPair</span> <span class="o">=</span> <span class="n">GTMOEPDataPair</span><span class="p">(</span><span class="n">dataList</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dataList</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">newDataPair</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Jason Zutty, Austin Dunn, Milind Lingineni, Bhargava Samanthula.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>