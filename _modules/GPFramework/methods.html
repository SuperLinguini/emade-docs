
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>GPFramework.methods &#8212; EMADE 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for GPFramework.methods</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Programmed by Jason Zutty</span>
<span class="sd">Modified by VIP Team</span>
<span class="sd">Implements a number of machine learning methods for use with deap</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">GPFramework.signal_methods</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="k">import</span> <span class="n">KNeighborsClassifier</span><span class="p">,</span> <span class="n">BallTree</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">OrthogonalMatchingPursuit</span><span class="p">,</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="n">BaggingClassifier</span><span class="p">,</span> <span class="n">GradientBoostingClassifier</span><span class="p">,</span> <span class="n">AdaBoostClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="k">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="k">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="k">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.gaussian_process</span> <span class="k">import</span> <span class="n">GaussianProcess</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="k">import</span> <span class="n">KMeans</span><span class="p">,</span> <span class="n">SpectralClustering</span><span class="p">,</span> <span class="n">AgglomerativeClustering</span><span class="p">,</span> <span class="n">Birch</span>
<span class="kn">from</span> <span class="nn">sklearn.mixture</span> <span class="k">import</span> <span class="n">GaussianMixture</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="k">import</span> <span class="n">MLPClassifier</span>
<span class="kn">from</span> <span class="nn">keras.layers.core</span> <span class="k">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Activation</span><span class="p">,</span> <span class="n">Dropout</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">keras.wrappers.scikit_learn</span> <span class="k">import</span> <span class="n">KerasClassifier</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span>  <span class="o">!=</span> <span class="s1">&#39;win32&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">resource</span>

<span class="n">best_estimators</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;KNN&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;SVM&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Bayes&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;DNN&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
                   <span class="s1">&#39;Trees&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;RandForest&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;Boosting&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
                   <span class="s1">&#39;LogR&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">}</span>

<div class="viewcode-block" id="mod_select"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.mod_select">[docs]</a><span class="k">def</span> <span class="nf">mod_select</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">dictionary</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Selects based on key and mod</span>

<span class="sd">    Args:</span>
<span class="sd">        array: given array</span>
<span class="sd">        dictionary: given dictionary</span>
<span class="sd">        key: given key</span>

<span class="sd">    Returns:</span>
<span class="sd">        An item from the array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dictionary</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">integer</span> <span class="o">=</span> <span class="n">dictionary</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">array</span><span class="p">[</span><span class="n">integer</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="p">)]</span></div>

<div class="viewcode-block" id="print_mem"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.print_mem">[docs]</a><span class="k">def</span> <span class="nf">print_mem</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s2">&quot;linux&quot;</span> <span class="ow">or</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s2">&quot;linux2&quot;</span><span class="p">:</span>
        <span class="n">mem</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">getrusage</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">RUSAGE_SELF</span><span class="p">)</span><span class="o">.</span><span class="n">ru_maxrss</span> <span class="o">/</span> <span class="mf">1024.0</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">mem</span><span class="p">,</span> <span class="s1">&#39;MB&#39;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></div>


<div class="viewcode-block" id="target_value_check"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.target_value_check">[docs]</a><span class="k">def</span> <span class="nf">target_value_check</span><span class="p">(</span><span class="n">targets</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Checks target value</span>

<span class="sd">    Args:</span>
<span class="sd">        targets: given targets</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">unique_targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_targets</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Only one target: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">unique_targets</span><span class="p">))</span></div>


<div class="viewcode-block" id="obsSelect"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.obsSelect">[docs]</a><span class="k">def</span> <span class="nf">obsSelect</span><span class="p">(</span><span class="n">obsMat</span><span class="p">,</span> <span class="n">obsVec</span><span class="p">,</span> <span class="n">obsNum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a tuple of features and their results from a given observation</span>

<span class="sd">    Args:</span>
<span class="sd">        obsMat: observation matrix</span>
<span class="sd">        obsVec: observation vector</span>
<span class="sd">        obsNum: observation number</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple containing a set of features from a given observation and the</span>
<span class="sd">        result of those features</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">obsMat</span><span class="p">[</span><span class="n">obsNum</span><span class="p">,</span> <span class="p">:],</span> <span class="n">obsVec</span><span class="p">[</span><span class="n">obsNum</span><span class="p">])</span></div>


<div class="viewcode-block" id="featSelect"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.featSelect">[docs]</a><span class="k">def</span> <span class="nf">featSelect</span><span class="p">(</span><span class="n">obsMat</span><span class="p">,</span> <span class="n">obsVec</span><span class="p">,</span> <span class="n">featNum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a tuple of a set of observations of a given feature and the</span>
<span class="sd">    resulting vector of those features</span>

<span class="sd">    Args:</span>
<span class="sd">        obsMat: observation matrix</span>
<span class="sd">        obsVec: observation vector</span>
<span class="sd">        featNum: feature number</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple containing a set of observations of a given feature and the</span>
<span class="sd">        result vector of those features</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">obsMat</span><span class="p">[:,</span> <span class="n">featNum</span><span class="p">],</span> <span class="n">obsVec</span><span class="p">)</span></div>

<div class="viewcode-block" id="machineLearning"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.machineLearning">[docs]</a><span class="k">class</span> <span class="nc">machineLearning</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>


<span class="n">machineLearnerPath</span> <span class="o">=</span> <span class="s1">&#39;/tmp/ramdisk/&#39;</span>


<div class="viewcode-block" id="setPath"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.setPath">[docs]</a><span class="k">def</span> <span class="nf">setPath</span><span class="p">(</span><span class="n">newMachineLearnerPath</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">machineLearnerPath</span>
    <span class="n">machineLearnerPath</span> <span class="o">=</span> <span class="n">newMachineLearnerPath</span></div>

<div class="viewcode-block" id="build_dnn_model"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.build_dnn_model">[docs]</a><span class="k">def</span> <span class="nf">build_dnn_model</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Builds DNN model for keras classifier</span>

<span class="sd">    Returns:</span>
<span class="sd">        compiled dense neural network model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">113</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="mi">113</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
    <span class="c1"># model.add(Dense(256, kernel_initializer=&#39;normal&#39;, activation=&#39;relu&#39;))</span>
    <span class="c1"># model.add(Dropout(0.2))</span>
    <span class="c1"># model.add(Dense(256, kernel_initializer=&#39;normal&#39;, activation=&#39;relu&#39;))</span>
    <span class="c1"># model.add(Dropout(0.2))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">model</span></div>

<div class="viewcode-block" id="NN_keras"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.NN_keras">[docs]</a><span class="k">def</span> <span class="nf">NN_keras</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs a neural network classifier using keras and tensorflow</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of the DNN classifier</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">KerasClassifier</span><span class="p">(</span><span class="n">build_fn</span><span class="o">=</span><span class="n">build_dnn_model</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>

    <span class="n">predicted</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;dnn&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="knn_scikit"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.knn_scikit">[docs]</a><span class="k">def</span> <span class="nf">knn_scikit</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs a kNN machine learning classifier using scikit-learn</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        k: number of nearest neighbors</span>
<span class="sd">        weights: weight function used in prediction</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of a kNN machine learner using scikit-learn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;knn_scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">neigh</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">neigh</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;knn_scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">neigh</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">neigh</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;kNN&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="bayes_scikit"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.bayes_scikit">[docs]</a><span class="k">def</span> <span class="nf">bayes_scikit</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs a naive bayes machine learning classifier using scikit-learn</span>

<span class="sd">    http://scikit-learn.org/stable/modules/naive_bayes.html#naive-bayes</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of a naive bayes machine learner using scikit-learn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>

    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;bayes_scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">bayes</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
    <span class="n">bayes</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;bayes_scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">bayes</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">bayes</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;bayes&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>

    <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="omp_scikit"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.omp_scikit">[docs]</a><span class="k">def</span> <span class="nf">omp_scikit</span><span class="p">(</span><span class="n">data_pair</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs an orthogonal matching pursuit machine learning classifier using scikit-learn</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.OrthogonalMatchingPursuit.html#sklearn.linear_model.OrthogonalMatchingPursuit</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of an orthogonal matching pursuit using scikit-learn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;omp_scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">omp</span> <span class="o">=</span> <span class="n">OrthogonalMatchingPursuit</span><span class="p">()</span>
    <span class="n">omp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;omp_scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">omp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">omp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;OMP&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="svc_scikit"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.svc_scikit">[docs]</a><span class="k">def</span> <span class="nf">svc_scikit</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs a SVM machine learning classifier using scikit-learn</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        kernel: the kernel type used in the algorithm</span>

<span class="sd">    Returns:</span>
<span class="sd">        a C-Support vector classification using scikit-learn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;svc_scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">svc</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">)</span>
    <span class="c1"># Putting this in a try due to a number of classes equal to 1 error... this should not be happening</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">svc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">target_values</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">target_values</span><span class="p">),</span> <span class="n">target_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span>
        <span class="k">raise</span> <span class="n">e</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;svc_scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;SVC&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="trees_scikit"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.trees_scikit">[docs]</a><span class="k">def</span> <span class="nf">trees_scikit</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s2">&quot;gini&quot;</span><span class="p">,</span> <span class="n">splitter</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs a decision tree machine learning classifier using scikit-learn</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html#sklearn.tree.DecisionTreeClassifier</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of a decision tree machine learner using scikit-learn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;trees_scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">tree</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span> <span class="n">splitter</span><span class="o">=</span><span class="n">splitter</span><span class="p">)</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;trees_scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Trees&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="random_forest_scikit"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.random_forest_scikit">[docs]</a><span class="k">def</span> <span class="nf">random_forest_scikit</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;gini&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs a random forest machine learning classifier using scikit-learn</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        n_estimators: number of decision trees in the forest</span>
<span class="sd">        class_weight: mode of dict, list of dicts for weights associated</span>
<span class="sd">        with classes</span>
<span class="sd">        criterion: the function to measure the quality of a split</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of a random forest machine learner using scikit-learn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;random_forest_scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">forest</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="n">class_weight</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">)</span>
    <span class="n">forest</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;random_forest_scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">forest</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Forest&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="boosting_scikit"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.boosting_scikit">[docs]</a><span class="k">def</span> <span class="nf">boosting_scikit</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>  <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs a gradient boosted machine learning classifier using scikit-learn</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        learning_rate: learning rate shrinks the contribution of each tree</span>
<span class="sd">        by learning_rate. There is a trade-off between learning_rate and</span>
<span class="sd">        n_estimators --sklearn</span>
<span class="sd">        n_estimators: number of boosting stages to perform</span>
<span class="sd">        max_depth: maximum depth of the individual regression estimators.</span>
<span class="sd">        The maximum depth limits the number of nodes in the tree. --sklearn</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of a gradient boosted machine learner using scikit-learn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;boosting_scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">boost</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">)</span>
    <span class="n">boost</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;boosting_scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">boost</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">boost</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Boosting&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="MLP_scikit"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.MLP_scikit">[docs]</a><span class="k">def</span> <span class="nf">MLP_scikit</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">),</span>  <span class="n">alpha</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">learning_rate_init</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs a multi-layer perceptron machine learning classifier using scikit-learn</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPClassifier.html</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        hidden_layer_sizes: number of layers and number of nodes in each layer</span>
<span class="sd">        alpha: L2 regularization penalty</span>
<span class="sd">        learning_rate: learning rate schedule for weight updates --sklearn</span>
<span class="sd">        learning_rate_init: the initial learning rate used</span>
<span class="sd">        momentum: momentum for gradient descent update</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of a multi-layer perceptron machine learner using scikit-learn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MLP_scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="n">hidden_layer_sizes</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">,</span> <span class="n">learning_rate_init</span><span class="o">=</span><span class="n">learning_rate_init</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="n">momentum</span><span class="p">)</span>
    <span class="n">mlp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MLP_scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">mlp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">mlp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;MLP&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="best_linear_unbiased_estimate"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.best_linear_unbiased_estimate">[docs]</a><span class="k">def</span> <span class="nf">best_linear_unbiased_estimate</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">theta_0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">theta_l</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                  <span class="n">theta_u</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    theta_0 An array with shape (n_features, ) or (1, ).</span>
<span class="sd">    The parameters in the autocorrelation model.</span>
<span class="sd">    If theta_l and theta_u are also specified,</span>
<span class="sd">    theta_0 is considered as the starting point for the maximum likelihood</span>
<span class="sd">    estimation of the best set of parameters.</span>
<span class="sd">    Default assumes isotropic autocorrelation model with theta0 = 1e-1.</span>
<span class="sd">    theta_l</span>
<span class="sd">    An array with shape matching theta_0&#39;s.</span>
<span class="sd">    Lower bound on the autocorrelation parameters for maximum likelihood</span>
<span class="sd">    estimation. Default is None, so that it skips maximum likelihood estimation</span>
<span class="sd">    and it uses theta_0.</span>
<span class="sd">    theta_u</span>
<span class="sd">    An array with shape matching theta0&#39;s.</span>
<span class="sd">    Upper bound on the autocorrelation parameters for maximum likelihood</span>
<span class="sd">    estimation. Default is None, so that it skips maximum likelihood estimation</span>
<span class="sd">    and it uses theta_0.</span>
<span class="sd">    -- From sklearn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;blup scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">blup</span> <span class="o">=</span> <span class="n">GaussianProcess</span><span class="p">(</span><span class="n">theta0</span><span class="o">=</span><span class="n">theta_0</span><span class="p">,</span> <span class="n">thetaL</span><span class="o">=</span><span class="n">theta_l</span><span class="p">,</span> <span class="n">thetaU</span><span class="o">=</span><span class="n">theta_u</span><span class="p">)</span>
    <span class="n">blup</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;blup scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">blup</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">blup</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;BLUP&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="kmeans_cluster_scikit"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.kmeans_cluster_scikit">[docs]</a><span class="k">def</span> <span class="nf">kmeans_cluster_scikit</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs a k-means machine learning clustering using scikit-learn</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        n_clusters: the number of clusters to form and the number of centroids</span>
<span class="sd">        to generate</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of a k-means clustering machine learner using scikit-learn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Fix to remove deprication warning about booleans</span>
    <span class="n">n_clusters</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">))</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;kmeans_cluster_scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">kmeans_cluster</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">)</span>
    <span class="n">kmeans_cluster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;kmeans_cluster_scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">kmeans_cluster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">kmeans_cluster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;KMEANS&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="agglomerative_cluster_scikit"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.agglomerative_cluster_scikit">[docs]</a><span class="k">def</span> <span class="nf">agglomerative_cluster_scikit</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">8</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs an agglomerative clustering machine learning using scikit-learn</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.cluster.AgglomerativeClustering.html</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        n_clusters: the number of clusters to form and the number of centroids</span>
<span class="sd">        to generate</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of a agglomerative clustering machine learner using scikit-learn</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">n_clusters</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">))</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;agglomerative_cluster_scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">agglomerative_cluster</span> <span class="o">=</span> <span class="n">AgglomerativeClustering</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">)</span>
    <span class="n">agglomerative_cluster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;agglomerative_cluster_scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">agglomerative_cluster</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">agglomerative_cluster</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;AGGLOMERATIVE&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="birch_cluster_scikit"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.birch_cluster_scikit">[docs]</a><span class="k">def</span> <span class="nf">birch_cluster_scikit</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">branching_factor</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs an birch clustering machine learning using scikit-learn</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.cluster.Birch.html</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        n_clusters: the number of clusters to form and the number of centroids</span>
<span class="sd">        to generate</span>
<span class="sd">        branching_factor: Maximum number of CF subclusters in each node</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of a birch clustering machine learner using scikit-learn</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">n_clusters</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">))</span>
    <span class="n">branching_factor</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">branching_factor</span><span class="p">))</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;birch_cluster_scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">birch_cluster</span> <span class="o">=</span> <span class="n">Birch</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">branching_factor</span><span class="o">=</span><span class="n">branching_factor</span><span class="p">)</span>
    <span class="n">birch_cluster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;birch_cluster_scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">birch_cluster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">birch_cluster</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;BIRCH&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="ball_tree_cluster_scikit"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.ball_tree_cluster_scikit">[docs]</a><span class="k">def</span> <span class="nf">ball_tree_cluster_scikit</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">leaf_size</span><span class="o">=</span><span class="mi">40</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements scikit ball tree</span>
<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.neighbors.BallTree.html</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ball_tree_cluster_scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">ball_tree_cluster</span> <span class="o">=</span> <span class="n">BallTree</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">leaf_size</span><span class="o">=</span><span class="n">leaf_size</span><span class="p">)</span>
    <span class="c1"># ball_tree_cluster.fit(training_data, target_values)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ball_tree_cluster_scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">ball_tree_cluster</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">ball_tree_cluster</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;BALLTREE&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="logistic_regression_scikit"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.logistic_regression_scikit">[docs]</a><span class="k">def</span> <span class="nf">logistic_regression_scikit</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span>
                               <span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">intercept_scaling</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                               <span class="n">class_weight</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                               <span class="n">multi_class</span><span class="o">=</span><span class="s1">&#39;ovr&#39;</span><span class="p">,</span> <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs a logistic regression machine learning classifier using scikit-learn</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html#sklearn.linear_model.LogisticRegression</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        penalty: number of nearest neighbors</span>
<span class="sd">        dual: weight function used in prediction</span>
<span class="sd">        tol: Tolerance for stopping criteria --sklearn</span>
<span class="sd">        C: Inverse of regularization strength --sklearn</span>
<span class="sd">        fit_intercept: Specifies if a constant (a.k.a. bias or intercept)</span>
<span class="sd">        should be added to the decision function. --sklearn</span>
<span class="sd">        intercept_scaling: changes the intercept</span>
<span class="sd">        class_weight: Weights associated with classes in the form</span>
<span class="sd">        {class_label: weight} --sklearn</span>
<span class="sd">        solver: Algorithm to use in the optimization problem --sklearn</span>
<span class="sd">        max_iter: Maximum number of iterations taken for the solvers to</span>
<span class="sd">        converge --sklearn</span>
<span class="sd">        multi_class: If the option chosen is ovr, then a binary problem is</span>
<span class="sd">        fit for each label. Else the loss minimised is the multinomial loss</span>
<span class="sd">        fit across the entire probability distribution. --sklearn</span>
<span class="sd">        warm_start: When set to True, reuse the solution of the previous call</span>
<span class="sd">        to fit as initialization, otherwise, just erase the previous solution.</span>
<span class="sd">        Useless for liblinear solver. --sklearn</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of a logistic regression machine learner using scikit-learn</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;logistic_regression_scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">logistic_regression</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="n">penalty</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span><span class="n">dual</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span>
                                             <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="n">fit_intercept</span><span class="p">,</span>
                                             <span class="n">intercept_scaling</span><span class="o">=</span><span class="n">intercept_scaling</span><span class="p">,</span>
                                             <span class="n">class_weight</span><span class="o">=</span><span class="n">class_weight</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">,</span>
                                             <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span>
                                             <span class="n">multi_class</span><span class="o">=</span><span class="n">multi_class</span><span class="p">,</span> <span class="n">warm_start</span><span class="o">=</span><span class="n">warm_start</span><span class="p">)</span>
    <span class="n">logistic_regression</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;logistic_regression_scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">logistic_regression</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">logistic_regression</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LOGR&#39;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="spectral_cluster_scikit"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.spectral_cluster_scikit">[docs]</a><span class="k">def</span> <span class="nf">spectral_cluster_scikit</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">eigen_solver</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs a spectral machine learning clustering using scikit-learn</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.cluster.SpectralClustering.html#sklearn.cluster.SpectralClustering</span>

<span class="sd">    .. note::</span>

<span class="sd">       This method is currently unused.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        n_clusters: the dimension of the projection space</span>
<span class="sd">        eigen_solver: The eigenvalue decomposition strategy to use</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of a spectral clustering machine learner using scikit-learn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert n_clusters to int in case a boolean is received</span>
    <span class="n">n_clusters</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">))</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;spectral_cluster_scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">spectral_cluster</span> <span class="o">=</span> <span class="n">SpectralClustering</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">eigen_solver</span><span class="o">=</span><span class="n">eigen_solver</span><span class="p">)</span>
    <span class="n">spectral_cluster</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;spectral_cluster_scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">spectral_cluster</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">spectral_cluster</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;SPECTRAL&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="gmm_scikit"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.gmm_scikit">[docs]</a><span class="k">def</span> <span class="nf">gmm_scikit</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">covariance_type</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span>
               <span class="n">reg_covar</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">init_params</span><span class="o">=</span><span class="s1">&#39;kmeans&#39;</span><span class="p">,</span>
               <span class="n">weights_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">means_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">precisions_init</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs a gaussian mixture model machine learning clustering using scikit-learn</span>

<span class="sd">    http://scikit-learn.org/stable/modules/generated/sklearn.mixture.GaussianMixture.html#sklearn.mixture.GaussianMixture</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        n_components: The number of mixture components</span>
<span class="sd">        covariance_type: String describing the type of covariance parameters to use</span>
<span class="sd">        tol: The convergence threshold. EM iterations will stop when the lower</span>
<span class="sd">        bound average gain is below this threshold. --sklearn</span>
<span class="sd">        reg_covar: Non-negative regularization added to the diagonal of</span>
<span class="sd">        covariance. Allows to assure that the covariance matrices are all</span>
<span class="sd">        positive. --sklearn</span>
<span class="sd">        max_iter: The number of EM iterations to perform.</span>
<span class="sd">        n_init: The number of initializations to perform. The best results</span>
<span class="sd">        are kept. --sklearn</span>
<span class="sd">        init_params: The method used to initialize the weights, the means and</span>
<span class="sd">        the precisions. --sklearn</span>
<span class="sd">        weights_init: The user-provided initial weights</span>
<span class="sd">        means_init: The user-provided initial means</span>
<span class="sd">        precisions_init: The user-provided initial precisions</span>
<span class="sd">        warm_start: If warm_start is True, the solution of the last fitting is</span>
<span class="sd">        used as initialization for the next call of fit(). This can speed up</span>
<span class="sd">        convergence when fit is called several time on similar problems.</span>
<span class="sd">        --sklearn</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of a gaussian mixture model machine learner using scikit-learn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert n_components to int in case a boolean is received</span>
    <span class="n">n_components</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n_components</span><span class="p">))</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gmm_scikit: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">gmm_mixture</span> <span class="o">=</span> <span class="n">GaussianMixture</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">,</span> <span class="n">covariance_type</span><span class="o">=</span><span class="n">covariance_type</span><span class="p">,</span>
                                  <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">,</span> <span class="n">reg_covar</span><span class="o">=</span><span class="n">reg_covar</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="n">max_iter</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="n">n_init</span><span class="p">,</span>
                                  <span class="n">init_params</span><span class="o">=</span><span class="n">init_params</span><span class="p">,</span> <span class="n">weights_init</span><span class="o">=</span><span class="n">weights_init</span><span class="p">,</span> <span class="n">means_init</span><span class="o">=</span><span class="n">means_init</span><span class="p">,</span>
                                  <span class="n">precisions_init</span><span class="o">=</span><span class="n">precisions_init</span><span class="p">,</span> <span class="n">warm_start</span><span class="o">=</span><span class="n">warm_start</span><span class="p">)</span>
    <span class="n">gmm_mixture</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gmm_scikit: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">gmm_mixture</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># But then restore the training data to the class</span>
    <span class="c1"># Set the self-predictions of the training data</span>
    <span class="n">trained_classes</span> <span class="o">=</span> <span class="n">gmm_mixture</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">training_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">trained_classes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;GMM&quot;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="my_arg_max"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.my_arg_max">[docs]</a><span class="k">def</span> <span class="nf">my_arg_max</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs an arg max</span>

<span class="sd">    Assigns the index of the maximum for each row as the class for</span>
<span class="sd">    test data</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        sampling_rate: rate of data sample</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of an arg max</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="c1"># Cache the truth data for the training set</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">numpy_data</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
        <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arg_max&#39;</span><span class="p">,</span> <span class="n">numpy_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

        <span class="n">maxes</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">/</span> <span class="n">sampling_rate</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">numpy_data</span><span class="p">]</span>
        <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
         <span class="nb">zip</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">maxes</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ARGMAX&#39;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="my_arg_min"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.my_arg_min">[docs]</a><span class="k">def</span> <span class="nf">my_arg_min</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs an arg min</span>

<span class="sd">    Assigns the index of the minimum for each row as the class for</span>
<span class="sd">    test data</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        sampling_rate: rate of data sample</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of an arg min</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="c1"># Cache the truth data for the training set</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">numpy_data</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
        <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;arg_min&#39;</span><span class="p">,</span> <span class="n">numpy_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

        <span class="n">mins</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">/</span> <span class="n">sampling_rate</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">numpy_data</span><span class="p">]</span>
        <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
         <span class="nb">zip</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">mins</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ARGMIN&#39;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="my_depth_estimate"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.my_depth_estimate">[docs]</a><span class="k">def</span> <span class="nf">my_depth_estimate</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">off_nadir_angle</span><span class="o">=</span><span class="mf">20.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Runs a depth estimate</span>

<span class="sd">    Assigns difference between the first and last elements to</span>
<span class="sd">    the class for test data</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        sampling_rate: sample rate of the data</span>
<span class="sd">        off_nadir_angle: off_nadir_angle in degrees</span>

<span class="sd">    Returns:</span>
<span class="sd">        the result of a kNN machine learner using scikit-learn</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">off_nadir_angle</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">180.0</span> <span class="o">*</span> <span class="n">off_nadir_angle</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="c1"># Cache the truth data for the training set</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="p">[</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">(),</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()]:</span>
        <span class="n">numpy_data</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
        <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;depth_estimate&#39;</span><span class="p">,</span> <span class="n">numpy_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

        <span class="n">mins</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">numpy_data</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># print row</span>
                <span class="n">opl_estimate</span> <span class="o">=</span> <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">sampling_rate</span>
                <span class="n">refracted_angle</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">asin</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">off_nadir_angle</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.33</span><span class="p">)</span>
                <span class="n">depth_estimate</span> <span class="o">=</span> <span class="n">opl_estimate</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">refracted_angle</span><span class="p">)</span>
                <span class="n">mins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">depth_estimate</span><span class="p">)</span>
                <span class="c1"># mins.append(np.min(np.diff(np.unique(row)))/sampling_rate)</span>
            <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">no_bottom_error</span><span class="p">:</span>
                <span class="n">mins</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
         <span class="nb">zip</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">mins</span><span class="p">)]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">makeFeatureFromClass</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;DepthEstimate&#39;</span><span class="p">)</span>
    <span class="c1"># Restore the training data</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">target_values</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="get_scikit_model"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.get_scikit_model">[docs]</a><span class="k">def</span> <span class="nf">get_scikit_model</span><span class="p">(</span><span class="n">learner</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a machine learning classifier</span>

<span class="sd">    Given a learner object, produce an estimator that can be used</span>
<span class="sd">    either by itself, or with an ensemble technique</span>

<span class="sd">    Args:</span>
<span class="sd">        learner: type of machine learning classifier to return</span>

<span class="sd">    Returns:</span>
<span class="sd">        a machine learning classifier</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">==</span> <span class="s1">&#39;KNN&#39;</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]))</span>
        <span class="n">weights_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">]</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">mod_select</span><span class="p">(</span><span class="n">weights_list</span><span class="p">,</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">,</span> <span class="s1">&#39;weights&#39;</span><span class="p">)</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">k</span><span class="p">,</span>
                                         <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
        <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_neighbors&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
                      <span class="s1">&#39;weights&#39;</span><span class="p">:</span><span class="n">weights_list</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">==</span> <span class="s1">&#39;SVM&#39;</span><span class="p">:</span>
        <span class="n">C</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]))</span>
        <span class="n">kernels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;poly&#39;</span><span class="p">,</span> <span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="s1">&#39;sigmoid&#39;</span><span class="p">]</span>
        <span class="n">kernel</span> <span class="o">=</span> <span class="n">mod_select</span><span class="p">(</span><span class="n">kernels</span><span class="p">,</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">,</span> <span class="s1">&#39;kernel&#39;</span><span class="p">)</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">)</span>
        <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span>
                      <span class="s1">&#39;kernel&#39;</span><span class="p">:</span><span class="n">kernels</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">==</span> <span class="s1">&#39;Bayes&#39;</span><span class="p">:</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">(</span><span class="n">priors</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;priors&#39;</span><span class="p">:[</span><span class="kc">None</span><span class="p">]}</span>
    <span class="k">elif</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">==</span> <span class="s1">&#39;DNN&#39;</span><span class="p">:</span>
        <span class="n">epochs</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">[</span><span class="s1">&#39;epochs&#39;</span><span class="p">]))</span>
        <span class="n">batch_size</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">[</span><span class="s1">&#39;batch_size&#39;</span><span class="p">]))</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="n">KerasClassifier</span><span class="p">(</span><span class="n">build_fn</span><span class="o">=</span><span class="n">build_dnn_model</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;epochs&#39;</span><span class="p">:[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
                      <span class="s1">&#39;batch_size&#39;</span><span class="p">:[</span><span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">]}</span>
    <span class="k">elif</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">==</span> <span class="s1">&#39;Trees&#39;</span><span class="p">:</span>
        <span class="n">criterions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="s1">&#39;entropy&#39;</span><span class="p">]</span>
        <span class="n">criterion</span> <span class="o">=</span> <span class="n">mod_select</span><span class="p">(</span><span class="n">criterions</span><span class="p">,</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">,</span> <span class="s1">&#39;criterion&#39;</span><span class="p">)</span>
        <span class="n">splitters</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="s1">&#39;random&#39;</span><span class="p">]</span>
        <span class="n">splitter</span> <span class="o">=</span> <span class="n">mod_select</span><span class="p">(</span><span class="n">splitters</span><span class="p">,</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">,</span> <span class="s1">&#39;splitter&#39;</span><span class="p">)</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">,</span> <span class="n">splitter</span><span class="o">=</span><span class="n">splitter</span><span class="p">)</span>
        <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;criterion&#39;</span><span class="p">:</span><span class="n">criterions</span><span class="p">,</span>
                      <span class="s1">&#39;splitter&#39;</span><span class="p">:</span><span class="n">splitters</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">==</span> <span class="s1">&#39;RandForest&#39;</span><span class="p">:</span>
        <span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">[</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">]))</span>
        <span class="n">class_weights</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;balanced&#39;</span><span class="p">,</span> <span class="s1">&#39;balanced_subsample&#39;</span><span class="p">]</span>
        <span class="n">class_weight</span> <span class="o">=</span> <span class="n">mod_select</span><span class="p">(</span><span class="n">class_weights</span><span class="p">,</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">,</span> <span class="s1">&#39;class_weight&#39;</span><span class="p">)</span>
        <span class="n">criterions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="s1">&#39;entropy&#39;</span><span class="p">]</span>
        <span class="n">criterion</span> <span class="o">=</span> <span class="n">mod_select</span><span class="p">(</span><span class="n">criterions</span><span class="p">,</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">,</span> <span class="s1">&#39;criterion&#39;</span><span class="p">)</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span>
                                           <span class="n">class_weight</span><span class="o">=</span><span class="n">class_weight</span><span class="p">,</span>
                                           <span class="n">criterion</span><span class="o">=</span><span class="n">criterion</span><span class="p">)</span>
        <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>
                      <span class="s1">&#39;class_weight&#39;</span><span class="p">:</span><span class="n">class_weights</span><span class="p">,</span>
                      <span class="s1">&#39;criterion&#39;</span><span class="p">:</span><span class="n">criterions</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">==</span> <span class="s1">&#39;Boosting&#39;</span><span class="p">:</span>
        <span class="n">learning_rate</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">[</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">]))</span>
        <span class="n">n_estimators</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">[</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">]))</span>
        <span class="n">max_depth</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">[</span><span class="s1">&#39;max_depth&#39;</span><span class="p">]))</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">,</span>
                                            <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span>
                                            <span class="n">max_depth</span><span class="o">=</span><span class="n">max_depth</span><span class="p">)</span>
        <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">:[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span>
                      <span class="s1">&#39;n_estimators&#39;</span><span class="p">:[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">]}</span>
    <span class="k">elif</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">==</span> <span class="s1">&#39;Kmeans&#39;</span><span class="p">:</span>
        <span class="n">n_clusters</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">[</span><span class="s1">&#39;n_clusters&#39;</span><span class="p">]))</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">)</span>
        <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_clusters&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]}</span>
    <span class="c1"># elif learner.learnerName == &#39;OMP&#39;:</span>
    <span class="c1">#     estimator = OrthogonalMatchingPursuit()</span>
    <span class="c1"># elif learner.learnerName == &#39;GMM&#39;:</span>
    <span class="c1">#     n_components = abs(int(learner.learnerParams[&#39;n_components&#39;]))</span>
    <span class="c1">#     covariance_types = [&#39;full&#39;, &#39;tied&#39;, &#39;diag&#39;, &#39;spectral&#39;]</span>
    <span class="c1">#     covariance_type = mod_select(covariance_types, learner.learnerParams, &#39;covariance_type&#39;)</span>
    <span class="c1">#     estimator = GaussianMixture(n_components=n_components, covariance_type=covariance_type)</span>
    <span class="k">elif</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">==</span> <span class="s1">&#39;LogR&#39;</span><span class="p">:</span>
        <span class="c1"># Let&#39;s look at the integer parameter and mod it to one of two choices</span>
        <span class="n">penalties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span> <span class="s1">&#39;l1&#39;</span><span class="p">]</span>
        <span class="n">penalty</span> <span class="o">=</span> <span class="n">mod_select</span><span class="p">(</span><span class="n">penalties</span><span class="p">,</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">,</span> <span class="s1">&#39;penalty&#39;</span><span class="p">)</span>
        <span class="n">C</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]))</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="n">penalty</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
        <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span>
                      <span class="s1">&#39;penalty&#39;</span><span class="p">:</span><span class="n">penalties</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># This can occur if we specify a learner not implemented in scikit</span>
        <span class="n">estimator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">param_grid</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">estimator</span><span class="p">,</span> <span class="n">param_grid</span></div>


<div class="viewcode-block" id="single_learner"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.single_learner">[docs]</a><span class="k">def</span> <span class="nf">single_learner</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">learner</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates labels and feature data from machine learning classifier</span>

<span class="sd">    Given a dataset and learner object, produce labled data and feature data</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        learner: type of machine learning classifier</span>

<span class="sd">    Returns:</span>
<span class="sd">        feature and label data</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">==</span> <span class="s1">&#39;ArgMax&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">my_arg_max</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span>
                          <span class="n">sampling_rate</span><span class="o">=</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">[</span><span class="s1">&#39;sampling_rate&#39;</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">==</span> <span class="s1">&#39;ArgMin&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">my_arg_min</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span>
                          <span class="n">sampling_rate</span><span class="o">=</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">[</span><span class="s1">&#39;sampling_rate&#39;</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">==</span> <span class="s1">&#39;DepthEstimate&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">my_depth_estimate</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span>
                                 <span class="n">sampling_rate</span><span class="o">=</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerParams</span><span class="p">[</span><span class="s1">&#39;sampling_rate&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Get the underlying base esitmator to use</span>
        <span class="n">get_model</span> <span class="o">=</span> <span class="n">get_scikit_model</span><span class="p">(</span><span class="n">learner</span><span class="p">)</span>
        <span class="n">base_estimator</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
        <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
        <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                                  <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
        <span class="c1"># Check for multiple target values</span>
        <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
        <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">+</span> <span class="s1">&#39;: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

        <span class="n">base_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
        <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">+</span> <span class="s1">&#39;: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

        <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">base_estimator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
        <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
         <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

        <span class="c1"># # Let&#39;s make the predictions a feature through use of the make feature from class,</span>
        <span class="c1"># # But then restore the training data to the class</span>
        <span class="c1"># # Set the self-predictions of the training data</span>
        <span class="c1"># trained_classes = base_estimator.predict(training_data)</span>
        <span class="c1"># [inst.set_target([target]) for inst, target in</span>
        <span class="c1">#  zip(data_pair.get_train_data().get_instances(), trained_classes)]</span>
        <span class="c1">#</span>
        <span class="c1"># data_pair = sm.makeFeatureFromClass(data_pair, name=learner.learnerName)</span>
        <span class="c1"># # Restore the training data</span>
        <span class="c1"># [inst.set_target([target]) for inst, target in</span>
        <span class="c1">#  zip(data_pair.get_train_data().get_instances(), target_values)]</span>
        <span class="k">return</span> <span class="n">data_pair</span></div>


<div class="viewcode-block" id="bagged_learner"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.bagged_learner">[docs]</a><span class="k">def</span> <span class="nf">bagged_learner</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">learner</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements scikit bagged model</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        learner: type of machine learning classifier</span>

<span class="sd">    Returns:</span>
<span class="sd">        feature and label data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the underlying base esitmator to use</span>
    <span class="c1"># If none is returned, the bagged classifier will use decision trees</span>
    <span class="n">get_model</span> <span class="o">=</span> <span class="n">get_scikit_model</span><span class="p">(</span><span class="n">learner</span><span class="p">)</span>
    <span class="n">base_estimator</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Bagged &#39;</span> <span class="o">+</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">+</span> <span class="s1">&#39;: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">bagged_classifier</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">base_estimator</span><span class="p">)</span>

    <span class="n">bagged_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Bagged &#39;</span> <span class="o">+</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">+</span> <span class="s1">&#39;: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">bagged_classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># # Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># # But then restore the training data to the class</span>
    <span class="c1"># # Set the self-predictions of the training data</span>
    <span class="c1"># trained_classes = bagged_classifier.predict(training_data)</span>
    <span class="c1"># [inst.set_target([target]) for inst, target in</span>
    <span class="c1">#  zip(data_pair.get_train_data().get_instances(), trained_classes)]</span>
    <span class="c1">#</span>
    <span class="c1"># data_pair = sm.makeFeatureFromClass(data_pair, name=&#39;Bagged&#39; + learner.learnerName)</span>
    <span class="c1"># # Restore the training data</span>
    <span class="c1"># [inst.set_target([target]) for inst, target in</span>
    <span class="c1">#  zip(data_pair.get_train_data().get_instances(), target_values)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="adaboost_learner"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.adaboost_learner">[docs]</a><span class="k">def</span> <span class="nf">adaboost_learner</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">learner</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Implements scikit AdaBoost classifier</span>

<span class="sd">    There is a trade-off between learning_rate and n_estimators. --sklearn</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        learner: type of machine learning classifier</span>
<span class="sd">        n_estimators: number of estimators in ensemble</span>
<span class="sd">        learning_rate: shrinks the contributionof each classifier</span>

<span class="sd">    Returns:</span>
<span class="sd">        feature and label data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Avoiding 0 estimators error by setting estimators to default</span>
    <span class="k">if</span> <span class="n">n_estimators</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">n_estimators</span> <span class="o">=</span> <span class="mi">50</span>

    <span class="c1"># Get the underlying base esitmator to use</span>
    <span class="n">get_model</span> <span class="o">=</span> <span class="n">get_scikit_model</span><span class="p">(</span><span class="n">learner</span><span class="p">)</span>
    <span class="n">base_estimator</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;AdaBoost &#39;</span> <span class="o">+</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">+</span> <span class="s1">&#39;: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">==</span> <span class="s2">&quot;SVM&quot;</span><span class="p">:</span>
        <span class="n">boost_classifier</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">base_estimator</span><span class="p">,</span>
                            <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">,</span>
                            <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;SAMME&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">==</span> <span class="s2">&quot;DNN&quot;</span> <span class="ow">or</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">==</span> <span class="s2">&quot;KNN&quot;</span><span class="p">:</span>
        <span class="c1"># default to single_learner if classifier can&#39;t be boosted</span>
        <span class="n">base_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">boost_classifier</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">base_estimator</span><span class="p">,</span>
                        <span class="n">n_estimators</span><span class="o">=</span><span class="n">n_estimators</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">)</span>

    <span class="n">boost_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>
    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;AdaBoost &#39;</span> <span class="o">+</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">+</span> <span class="s1">&#39;: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">boost_classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># # Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># # But then restore the training data to the class</span>
    <span class="c1"># # Set the self-predictions of the training data</span>
    <span class="c1"># trained_classes = boost_classifier.predict(training_data)</span>
    <span class="c1"># [inst.set_target([target]) for inst, target in</span>
    <span class="c1">#  zip(data_pair.get_train_data().get_instances(), trained_classes)]</span>
    <span class="c1">#</span>
    <span class="c1"># data_pair = sm.makeFeatureFromClass(data_pair, name=&#39;Bagged&#39; + learner.learnerName)</span>
    <span class="c1"># # Restore the training data</span>
    <span class="c1"># [inst.set_target([target]) for inst, target in</span>
    <span class="c1">#  zip(data_pair.get_train_data().get_instances(), target_values)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>

<div class="viewcode-block" id="grid_learner"><a class="viewcode-back" href="../../GPFramework.html#GPFramework.methods.grid_learner">[docs]</a><span class="k">def</span> <span class="nf">grid_learner</span><span class="p">(</span><span class="n">data_pair</span><span class="p">,</span> <span class="n">learner</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements scikit Grid Search cross validation</span>

<span class="sd">    Args:</span>
<span class="sd">        data_pair: given dataset</span>
<span class="sd">        learner: type of machine learning classifier</span>

<span class="sd">    Returns:</span>
<span class="sd">        feature and label data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get the underlying base esitmator to use</span>
    <span class="n">get_model</span> <span class="o">=</span> <span class="n">get_scikit_model</span><span class="p">(</span><span class="n">learner</span><span class="p">)</span>
    <span class="n">base_estimator</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">data_pair</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">data_pair</span><span class="p">)</span>
    <span class="n">training_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">inst</span><span class="o">.</span><span class="n">get_target</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span>
                              <span class="n">inst</span> <span class="ow">in</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_train_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()])</span>
    <span class="c1"># Check for multiple target values</span>
    <span class="n">target_value_check</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    <span class="c1"># For debugging purposes let&#39;s print out name of the function and dimensions of the data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GridSearch &#39;</span> <span class="o">+</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">+</span> <span class="s1">&#39;: training&#39;</span><span class="p">,</span> <span class="n">training_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">best_estimators</span><span class="p">[</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">grid_classifier</span> <span class="o">=</span> <span class="n">best_estimators</span><span class="p">[</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">grid_classifier</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">base_estimator</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
        <span class="n">grid_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_data</span><span class="p">,</span> <span class="n">target_values</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">best_estimators</span><span class="p">[</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">best_estimators</span><span class="p">[</span><span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid_classifier</span><span class="o">.</span><span class="n">best_estimator_</span>

    <span class="n">testing_data</span> <span class="o">=</span> <span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_numpy</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;GridSearch &#39;</span> <span class="o">+</span> <span class="n">learner</span><span class="o">.</span><span class="n">learnerName</span> <span class="o">+</span> <span class="s1">&#39;: testing&#39;</span><span class="p">,</span> <span class="n">testing_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

    <span class="n">predicted_classes</span> <span class="o">=</span> <span class="n">grid_classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
    <span class="p">[</span><span class="n">inst</span><span class="o">.</span><span class="n">set_target</span><span class="p">([</span><span class="n">target</span><span class="p">])</span> <span class="k">for</span> <span class="n">inst</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span>
     <span class="nb">zip</span><span class="p">(</span><span class="n">data_pair</span><span class="o">.</span><span class="n">get_test_data</span><span class="p">()</span><span class="o">.</span><span class="n">get_instances</span><span class="p">(),</span> <span class="n">predicted_classes</span><span class="p">)]</span>

    <span class="c1"># # Let&#39;s make the predictions a feature through use of the make feature from class,</span>
    <span class="c1"># # But then restore the training data to the class</span>
    <span class="c1"># # Set the self-predictions of the training data</span>
    <span class="c1"># trained_classes = grid_classifier.predict(training_data)</span>
    <span class="c1"># [inst.set_target([target]) for inst, target in</span>
    <span class="c1">#  zip(data_pair.get_train_data().get_instances(), trained_classes)]</span>
    <span class="c1">#</span>
    <span class="c1"># data_pair = sm.makeFeatureFromClass(data_pair, name=&#39;GridSearch&#39; + learner.learnerName)</span>
    <span class="c1"># # Restore the training data</span>
    <span class="c1"># [inst.set_target([target]) for inst, target in</span>
    <span class="c1">#  zip(data_pair.get_train_data().get_instances(), target_values)]</span>
    <span class="k">return</span> <span class="n">data_pair</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Jason Zutty, Austin Dunn, Milind Lingineni, Bhargava Samanthula.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>